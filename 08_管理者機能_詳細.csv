大分類,中分類,項目,詳細内容
━━━ UI基本設計書 ━━━,,,
基本情報,機能名,管理者機能,
,対象画面,管理者ダッシュボード ・ ユーザー管理ページ ・ キャラクター管理ページ ・ ガイド管理ページ,
,技術スタック,Next.js 15 ・ TypeScript ・ Prisma ・ PostgreSQL,
,作成日,2025-10-28,
━━━ 1. 画面概要 ━━━,,,
管理者ダッシュボード,機能,統計情報表示,システム全体の統計情報を表示 ・ ユーザー数・キャラクター数・チャット数・ポイント消費量など
,ファイル,src/app/admin/page.tsx,
ユーザー管理ページ,機能,ユーザー管理,全ユーザーを一覧表示 ・ 検索・権限編集・停止・ポイント管理・削除機能付き
,ファイル,src/app/admin/users/page.tsx,
キャラクター管理ページ,機能,キャラクター管理,全キャラクターを一覧表示 ・ 承認・編集・削除機能付き
,ファイル,src/app/admin/characters/page.tsx,
ガイド管理ページ,機能,ガイド管理,全ガイドを一覧表示 ・ 作成・編集・削除機能付き
,ファイル,src/app/admin/guides/page.tsx,
━━━ 2. 前提・制約 ━━━,,,
データ取得,方式,サーバーサイドで権限確認後にデータを取得 ・ ページネーション対応,
権限要件,必要権限,MODERATOR以上の権限が必要 ・ SUPER_ADMINは全ての機能にアクセス可能,
停止期間,選択肢,1日 ・ 3日 ・ 7日 ・ 1ヶ月 ・ 3ヶ月 ・ 100日 ・ 1年 ・ 永久停止から選択可能,
停止理由,必須項目,必須入力項目 ・ 停止時に理由を記録,
ポイント管理,管理機能,無料ポイント・有料ポイントを手動で設定可能,
ユーザー削除,削除処理,削除確認ダイアログ付き ・ 作成したキャラクターは匿名化して保持,
━━━ 3. 関連URL・遷移 ━━━,,,
URL一覧,/admin,管理者ダッシュボード,
,/admin/users,ユーザー管理ページ,
,/admin/characters,キャラクター管理ページ,
,/admin/guides,ガイド管理ページ,
遷移フロー,基本フロー,管理者ダッシュボード → 各管理ページ → 編集/削除,
━━━ 4. 役割・権限 ━━━,,,
SUPER_ADMIN,最高権限,全ての管理者機能にアクセス可能 ・ ユーザー権限変更・停止・削除・ポイント管理など,
CHAR_MANAGER,キャラクター権限,キャラクター管理機能にアクセス可能 ・ キャラクター承認・編集・削除,
MODERATOR,モデレーター権限,ユーザー管理機能にアクセス可能 ・ ユーザー停止・ガイド管理など,
USER,一般権限,管理者機能にアクセス不可,
━━━ 5. 主要機能一覧 ━━━,,,
ユーザー一覧閲覧,一覧表示,全ユーザーを一覧表示 ・ 検索・フィルタリング機能付き,
ユーザー検索,検索機能,ニックネーム・メールアドレスで検索 ・ 部分一致検索,
権限変更,権限管理,ユーザーの権限を変更（USER / MODERATOR / CHAR_MANAGER / SUPER_ADMIN） ・ ドロップダウンで選択,
ユーザー停止,停止機能,ユーザーを一定期間停止 ・ 停止期間と理由を入力 ・ 停止中はログイン不可,
停止解除,解除機能,停止中のユーザーを解除 ・ すぐにログイン可能に,
ユーザー情報編集,編集機能,名前・ニックネーム・メール・電話番号・自己紹介・権限を編集 ・ OAuth専用ユーザーの識別,
ポイント手動管理,ポイント管理,無料ポイント・有料ポイントを手動で設定 ・ 増減理由を記録,
ユーザー削除,削除機能,ユーザーを完全削除 ・ 作成したキャラクターは匿名化して保持 ・ 確認ダイアログ付き,
キャラクター一覧閲覧,一覧表示,全キャラクターを一覧表示 ・ 公開/非公開・作成者・作成日時を表示,
キャラクター承認,承認機能,新規キャラクターを承認 ・ 承認済みキャラクターのみ公開可能（将来実装）,
キャラクター編集,編集機能,管理者が他人のキャラクターを編集可能,
キャラクター削除,削除機能,管理者が他人のキャラクターを削除可能 ・ 確認ダイアログ付き,
ガイド一覧閲覧,一覧表示,全ガイドを一覧表示 ・ メインカテゴリー・サブカテゴリー・作成日時を表示,
ガイド作成,作成機能,新しいガイドを作成 ・ タイトル・内容・カテゴリーを設定,
ガイド編集,編集機能,既存ガイドを編集,
ガイド削除,削除機能,ガイドを削除 ・ 確認ダイアログ付き,
統計情報表示,ダッシュボード,ユーザー数・キャラクター数・チャット数・ポイント消費量などの統計をダッシュボードに表示,
━━━ 6. 画面構成（UIブロック） ━━━,,,
管理者ダッシュボード,統計カード,統計カード（ユーザー数・キャラクター数・チャット数・ポイント消費量）を4列で表示,
統計カード,表示要素,各統計情報を大きく表示 ・ 前日比・前週比を表示,
管理メニュー,ナビゲーション,ユーザー管理・キャラクター管理・ガイド管理へのリンク,
ユーザー一覧テーブル,テーブル表示,ニックネーム ・ メール ・ 権限 ・ 停止状態 ・ 作成日時 ・ アクションボタン（編集・停止・削除）を表示,
停止バッジ,ステータス表示,停止中ユーザーに「停止中」バッジを表示 ・ 正常ユーザーに「正常」バッジ,
権限ドロップダウン,権限変更,ユーザーの権限を変更するドロップダウン ・ 変更後は自動保存,
検索バー,検索欄,ニックネーム・メールアドレスで検索 ・ リアルタイムフィルタリング,
ユーザー停止モーダル,入力フォーム,停止期間選択（ドロップダウン） ・ 停止理由入力（テキストエリア） ・ 停止ボタン,
ユーザー編集モーダル,編集フォーム,名前 ・ ニックネーム ・ メール ・ 電話番号 ・ 自己紹介 ・ 権限を編集 ・ ポイント設定欄も含む,
ポイント管理欄,ポイント設定,無料ポイント・有料ポイントの入力欄 ・ 増減理由を記録,
ユーザー削除確認,確認ダイアログ,削除確認メッセージ ・ キャラクター匿名化の説明 ・ 最終確認ボタン,
キャラクター一覧テーブル,テーブル表示,名前 ・ 作成者 ・ カテゴリー ・ 公開/非公開 ・ 作成日時 ・ アクションボタン（編集・削除）を表示,
ガイド一覧テーブル,テーブル表示,タイトル ・ メインカテゴリー ・ サブカテゴリー ・ 作成日時 ・ アクションボタン（編集・削除）を表示,
ガイド作成フォーム,入力フォーム,タイトル ・ 内容 ・ メインカテゴリー ・ サブカテゴリー入力欄 ・ 保存ボタン,
━━━ 7. 画面項目定義 ━━━,,,
【ユーザー管理】ニックネーム,型: string,必須 ・ 1〜50文字,
【ユーザー管理】メールアドレス,型: string,必須 ・ メール形式チェック,
【ユーザー管理】権限,型: string,必須 ・ USER / MODERATOR / CHAR_MANAGER / SUPER_ADMIN,ドロップダウン
【ユーザー管理】停止期間,型: string,任意 ・ 1日 / 3日 / 7日 / 1ヶ月 / 3ヶ月 / 100日 / 1年 / 永久停止,ドロップダウン
【ユーザー管理】停止理由,型: string,停止時必須 ・ 1〜500文字,テキストエリア
【ユーザー管理】無料ポイント,型: number,任意 ・ 0以上,手動設定
【ユーザー管理】有料ポイント,型: number,任意 ・ 0以上,手動設定
【キャラクター管理】キャラクター名,型: string,必須 ・ 1〜100文字,
【キャラクター管理】作成者,型: string,必須 ・ ユーザーID,
【キャラクター管理】カテゴリー,型: string,必須 ・ 事前定義されたカテゴリーから選択,
【キャラクター管理】公開設定,型: boolean,必須 ・ true / false,
【ガイド管理】タイトル,型: string,必須 ・ 1〜200文字,
【ガイド管理】内容,型: string,必須 ・ 10〜10000文字,マークダウン対応
【ガイド管理】メインカテゴリー,型: string,必須 ・ 事前定義されたカテゴリーから選択,
【ガイド管理】サブカテゴリー,型: string,任意 ・ 事前定義されたカテゴリーから選択,
━━━ 8. フィルタ仕様 ━━━,,,
ユーザーフィルター,フィルター方式,権限・停止状態でフィルタリング可能,
キャラクターフィルター,フィルター方式,公開/非公開・カテゴリーでフィルタリング可能,
ガイドフィルター,フィルター方式,メインカテゴリー・サブカテゴリーでフィルタリング可能,
━━━ 9. API I/F 仕様 ━━━,,,
GET /api/admin/users,パラメータ,{ search? ・ role? ・ page ・ limit },レスポンス: { users: [] ・ total } ・ ユーザー一覧取得API
PUT /api/admin/users,パラメータ,{ userId ・ role },レスポンス: { success } ・ ユーザー権限変更API
POST /api/admin/users/suspend,パラメータ,{ userId ・ duration ・ reason },レスポンス: { success ・ suspendedUntil } ・ ユーザー停止API
DELETE /api/admin/users/suspend,パラメータ,{ userId },レスポンス: { success } ・ ユーザー停止解除API
PUT /api/admin/users/edit,パラメータ,{ userId ・ name ・ nickname ・ email ・ phone ・ bio ・ role ・ freePoints ・ paidPoints },レスポンス: { success } ・ ユーザー情報編集・ポイント管理API
DELETE /api/admin/users/delete,パラメータ,{ userId },レスポンス: { success ・ message } ・ ユーザー削除API
GET /api/admin/characters,パラメータ,{ page ・ limit },レスポンス: { characters: [] ・ total } ・ キャラクター一覧取得API
DELETE /api/admin/characters,パラメータ,{ characterId },レスポンス: { success } ・ キャラクター削除API
GET /api/admin/guides,パラメータ,{ category? ・ page ・ limit },レスポンス: { guides: [] ・ total } ・ ガイド一覧取得API
POST /api/admin/guides,パラメータ,{ title ・ content ・ mainCategory ・ subCategory },レスポンス: { success ・ guideId } ・ ガイド作成API
PUT /api/admin/guides,パラメータ,{ guideId ・ title ・ content ・ mainCategory ・ subCategory },レスポンス: { success } ・ ガイド編集API
DELETE /api/admin/guides,パラメータ,{ guideId },レスポンス: { success } ・ ガイド削除API
━━━ 10. エラー・通知文言 ━━━,,,
権限エラー,表示タイミング: 権限不足時,この操作を実行する権限がありません。,
停止エラー,表示タイミング: 停止理由未入力時,停止理由は必須です。,
削除確認（ユーザー）,表示タイミング: ユーザー削除ボタン押下時,このユーザーを削除してもよろしいですか？ 作成したキャラクターは匿名化して保持されます。,
削除確認（キャラクター）,表示タイミング: キャラクター削除ボタン押下時,このキャラクターを削除してもよろしいですか？ 関連するチャットとコメントも削除されます。,
削除確認（ガイド）,表示タイミング: ガイド削除ボタン押下時,このガイドを削除してもよろしいですか？,
成功メッセージ,表示タイミング: 権限変更成功時,ユーザー権限を変更しました。,
成功メッセージ,表示タイミング: 停止成功時,ユーザーを停止しました。,
成功メッセージ,表示タイミング: 停止解除成功時,ユーザーの停止を解除しました。,
成功メッセージ,表示タイミング: ユーザー情報編集成功時,ユーザー情報を更新しました。,
成功メッセージ,表示タイミング: ユーザー削除成功時,ユーザーを削除しました。,
成功メッセージ,表示タイミング: キャラクター削除成功時,キャラクターを削除しました。,
成功メッセージ,表示タイミング: ガイド作成成功時,ガイドを作成しました。,
成功メッセージ,表示タイミング: ガイド更新成功時,ガイドを更新しました。,
成功メッセージ,表示タイミング: ガイド削除成功時,ガイドを削除しました。,
━━━ 11. モーダル仕様 ━━━,,,
ユーザー停止モーダル,トリガー: 停止ボタン押下時,内容: 停止期間選択（ドロップダウン） ・ 停止理由入力（テキストエリア）,ボタン: キャンセル ・ 停止
停止解除確認,トリガー: 停止解除ボタン押下時,内容: 停止解除確認メッセージ,ボタン: キャンセル ・ 解除
ユーザー編集モーダル,トリガー: 編集ボタン押下時,内容: 名前 ・ ニックネーム ・ メール ・ 電話番号 ・ 自己紹介 ・ 権限 ・ ポイント編集フォーム,ボタン: キャンセル ・ 保存
ユーザー削除確認,トリガー: 削除ボタン押下時,内容: 削除確認メッセージ ・ キャラクター匿名化の説明,ボタン: キャンセル ・ 削除
キャラクター削除確認,トリガー: 削除ボタン押下時,内容: 削除確認メッセージ ・ 関連データ削除の警告,ボタン: キャンセル ・ 削除
ガイド削除確認,トリガー: 削除ボタン押下時,内容: 削除確認メッセージ,ボタン: キャンセル ・ 削除
━━━ 12. 認証・ガード ━━━,,,
権限チェック,制御方式,管理者ページはMODERATOR以上の権限が必要 ・ 権限不足時は403エラー表示,
機能別権限,権限制御,ユーザー管理: MODERATOR以上 ・ キャラクター管理: CHAR_MANAGER以上 ・ ガイド管理: MODERATOR以上,
━━━ 13. 非機能要件 ━━━,,,
パフォーマンス,最適化手法,ユーザー・キャラクター・ガイド一覧はページネーション対応 ・ 統計情報はキャッシュ,
セキュリティ,セキュリティ対策,管理者操作は全てログ記録 ・ 権限チェックはサーバーサイドで実施,
スケーラビリティ,拡張性,大量ユーザー・キャラクターにも対応 ・ インデックス最適化,
可用性,エラー処理,API失敗時はリトライ機能 ・ エラー時は適切なエラーメッセージ表示,
━━━ 14. テスト観点 ━━━,,,
権限チェック: アクセス可能,テストケース,MODERATOR以上の権限で管理者ページにアクセス可能確認,
権限チェック: アクセス不可,テストケース,USER権限で管理者ページにアクセス不可確認,
ユーザー検索: 検索機能,テストケース,ニックネーム・メールアドレスで検索動作確認,
権限変更: 即座反映,テストケース,ユーザーの権限を変更成功 ・ 即座に反映確認,
ユーザー停止: 記録確認,テストケース,ユーザーを停止成功 ・ 停止理由と期限の記録確認,
ユーザー停止: ログイン不可,テストケース,停止中ユーザーのログイン不可確認,
停止解除: ログイン可能,テストケース,停止解除後にユーザーがログイン可能確認,
ユーザー編集: 反映確認,テストケース,ユーザー情報編集成功 ・ ポイント設定反映確認,
ユーザー削除: 匿名化確認,テストケース,ユーザー削除成功 ・ キャラクター匿名化確認,
キャラクター管理: 機能確認,テストケース,キャラクター一覧表示・編集・削除動作確認,
ガイド管理: 機能確認,テストケース,ガイド作成・編集・削除動作確認,
統計情報: 正確性確認,テストケース,ダッシュボードに正確な統計情報表示確認,
━━━ 15. 今後の拡張余地 ━━━,,,
監査ログ,提案内容,全ての管理者操作をログに記録・閲覧機能,
一括操作,提案内容,複数ユーザーを一括停止・削除する機能,
高度な検索,提案内容,複雑な条件を組み合わせた検索機能,
統計レポート,提案内容,詳細な統計レポート生成・エクスポート機能,
通知システム,提案内容,管理者に重要なイベントを通知,
キャラクター承認フロー,提案内容,新規キャラクターの承認プロセスを実装,

# 📧 Gmail SMTP 設定ガイド

## ✅ Gmailのみで利用可能（別サービスの登録不要）

Gmailアカウントがあれば、nodemailerでメール送信が可能です。  
ただし、**セキュリティのため「アプリパスワード」の設定が必要**です。

---

## 🔐 Gmail アプリパスワード設定手順

### 1. Googleアカウントで2段階認証を有効化

1. [Googleアカウント](https://myaccount.google.com/) にログイン
2. **「セキュリティ」** タブを開く
3. **「2段階認証プロセス」** を有効にする
   - 携帯電話番号の確認が必要

### 2. アプリパスワードを生成

1. セキュリティページで **「アプリパスワード」** を探す
   - または直接: https://myaccount.google.com/apppasswords

2. **「アプリを選択」** → **「その他（カスタム名）」** を選択
   - 例: "NAMOSAI Email System"

3. **「生成」** をクリック
   - 16桁のパスワードが表示されます（例: `abcd efgh ijkl mnop`）

4. **このパスワードをコピー**（スペースは削除してOK）

### 3. 環境変数に設定

`.env.local` または本番環境の環境変数に設定：

```bash
EMAIL_USER=namoai.namos@gmail.com
EMAIL_PASSWORD=xbazodjqrgvayqhk  # ← アプリパスワード（スペースなし）
```

---

## ⚠️ 重要な注意事項

### Gmailの送信制限

- **1日あたり**: 約 **500通/日**（無料アカウント）
- これを超えると一時的に送信が制限されます

### 本番環境での推奨

**小規模サービス（1日500通以下）**: GmailでOK ✅  
**大規模サービス（500通超）**: 専用サービス推奨

---

## 🚀 より大規模なサービス向けの代替案（無料プランあり）

### 1. SendGrid（推奨）

- **無料プラン**: 100通/日
- **有料プラン**: $19.95/月（40,000通/月）
- **登録**: https://sendgrid.com

**設定例:**
```typescript
const transporter = nodemailer.createTransport({
  host: 'smtp.sendgrid.net',
  port: 587,
  auth: {
    user: 'apikey',
    pass: process.env.SENDGRID_API_KEY,
  },
});
```

### 2. AWS SES

- **無料プラン**: 62,000通/月（最初の1年間）
- **登録**: AWSアカウント必要
- **複雑さ**: 中程度

### 3. Mailgun

- **無料プラン**: 5,000通/月（最初の3ヶ月）
- **登録**: https://www.mailgun.com

---

## 📝 現在の実装状況

現在のコードは **Gmail SMTP** を使用しています。

**今すぐ使うには:**
1. ✅ Gmailアカウントで2段階認証を有効化
2. ✅ アプリパスワードを生成
3. ✅ 環境変数 `EMAIL_PASSWORD` にアプリパスワードを設定

**これで完了！別サービスの登録は不要です。**

---

## 🔍 トラブルシューティング

### 「認証に失敗しました」エラーが出る場合

- ❌ 通常のGmailパスワードを使用している
- ✅ **アプリパスワードを使用してください**

### 「送信に失敗しました」エラーが出る場合

- Gmailの1日送信制限（500通）に達している可能性
- 翌日まで待つか、SendGridなどのサービスに切り替え

---

**最終更新**: 2025-01-XX


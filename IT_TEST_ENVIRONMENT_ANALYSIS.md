# IT 테스트 환경 필요성 분석

## ① 개요

### 이 자료의 목적

본 자료는 **IT 테스트 환경(통합 테스트 환경)의 필요성과 비용**을 분석하여, 프로젝트 팀이 환경 구성을 결정할 수 있도록 지원합니다.

**분석 대상:**
- 로컬 테스트 환경 vs IT 테스트 환경 비교
- IT 테스트 환경 구축 비용 (AWS RDS 기준)
- 환경 구성 권장 사항

**대상 독자:**
- 프로젝트 관리자
- 개발 팀 리더
- 인프라 담당자

---

## ② 결론 (요점)

### 핵심 결론

**IT 테스트 환경은 개발자 3명 이상의 팀에서 권장됩니다.**

**비용:**
- 필요 시만 실행: **약 500-1,000 엔/월** (권장)
- 24시간 계속 실행: **약 3,275 엔/월** (비추천)
- AWS 프리 티어 적용 시: **0 엔/월** (12개월간, 750시간 이내)

**권장 구성:**
- **소규모 팀 (1-2명)**: 로컬 + 스테이징 (IT 환경 불필요)
- **중규모 팀 (3명 이상)**: 로컬 + IT 환경 + 스테이징 + 프로덕션

**구축 시간:** 약 4-6시간 소요 예상

---

## ③ 상세

### 1. 사실 (Fact)

#### 1.1 환경 비교

| 항목 | 로컬 테스트 환경 | IT 테스트 환경 |
|------|----------------|---------------|
| **위치** | 각 개발자 컴퓨터 | AWS RDS (클라우드) |
| **비용** | 0 엔/월 | 500-3,275 엔/월 |
| **속도** | 매우 빠름 | 보통 (네트워크 지연) |
| **독립성** | 각자 독립적 | 팀 공유 |
| **통합 테스트** | 어려움 | 가능 |
| **CI/CD 연동** | 어려움 | 가능 |

#### 1.2 IT 테스트 환경 비용 계산 (사실)

**환경 사양:**
- 인스턴스: PostgreSQL db.t3.micro
- 리전: ap-northeast-1c (도쿄)
- 배포: Single-AZ (Multi-AZ 아님)

**월 비용 계산 (24시간 실행 시):**
- DB 인스턴스: 0.026 USD/시간 × 24시간 × 30일 = 18.72 USD
- 스토리지 (20GB): 20GB × 0.115 USD/GB = 2.3 USD
- 백업 스토리지 (20GB): 20GB × 0.095 USD/GB = 1.9 USD
- 데이터 전송 (10GB): 첫 1GB 무료 + 9GB × 0.09 USD = 0.81 USD
- **총 월 비용: 약 23.73 USD ≈ 3,560 엔/월** (환율 1 USD = 150 JPY 기준)

**비용 절감 시나리오 (사실):**
- 월 40시간 사용: 약 500 엔/월
- 주 5일, 하루 8시간: 약 969 엔/월
- 24시간 계속 실행: 약 3,153 엔/월

**AWS 프리 티어 (사실):**
- 신규 AWS 계정은 12개월간 db.t3.micro 750시간/월 + 20GB 스토리지 무료
- 프리 티어 적용 시: 월 0 엔 (750시간 이내)

#### 1.3 환경 간 데이터 이동 방법 (사실)

**IT 환경 → 스테이징/프로덕션 환경:**

1. **API를 통한 캐릭터 Export/Import**
   - API 엔드포인트: `/api/characters/[id]/import`
   - IT 환경에서 JSON Export → 스테이징/프로덕션에서 Import

2. **데이터베이스 직접 마이그레이션**
   - `pg_dump`로 IT 환경 DB 백업
   - `pg_restore`로 스테이징/프로덕션 환경에 복원

3. **수동 복사**
   - IT 환경에서 캐릭터 정보 확인 후 스테이징/프로덕션에서 재생성

#### 1.4 IT 환경 제어 방법 (사실)

**관리 패널에서 제어:**
- 프로덕션 또는 스테이징 환경의 관리자 패널 (`/admin/it-environment`)에서 제어 가능
- SUPER_ADMIN 권한 필요
- 시작/중지/상태 확인 기능 제공

**AWS CLI로 제어:**
```bash
# 중지
aws rds stop-db-instance --db-instance-identifier namos-chat-it

# 시작
aws rds start-db-instance --db-instance-identifier namos-chat-it
```

---

### 2. 의견 (Opinion) 및 권장 사항

#### 2.1 IT 테스트 환경이 필요한 경우 (의견)

**판단 기준:**
- ✅ **팀 규모**: 개발자 3명 이상
- ✅ **CI/CD 파이프라인**: 자동화된 테스트 필요
- ✅ **통합 테스트**: 여러 시스템 간 통합 검증 필수
- ✅ **프로덕션 안정성**: 배포 전 실제 환경과 유사한 검증 필요

**이유:**
- 로컬 환경만으로는 여러 시스템 간 통합 테스트가 어려움
- CI/CD 파이프라인에서 자동화된 테스트 실행 필요
- 프로덕션 배포 전 문제를 사전에 발견하여 서비스 안정성 확보

#### 2.2 IT 테스트 환경이 불필요한 경우 (의견)

**판단 기준:**
- ❌ 개발자 1-2명
- ❌ 소규모 프로젝트
- ❌ 비용 제약
- ❌ 로컬 + 스테이징으로 충분

**이유:**
- 소규모 팀에서는 로컬 환경만으로도 충분한 테스트 가능
- 추가 비용 부담이 큰 경우
- 단순한 프로젝트는 통합 테스트 환경이 과도할 수 있음

#### 2.3 비용 절감 권장 사항 (의견)

**핵심 전략: 필요할 때만 실행하고, 끝나면 중지**

**권장 사용 패턴:**
- 테스트할 때만 IT 환경 시작
- 테스트 완료 후 즉시 중지
- 월 사용 시간: 약 20-40시간 목표
- 예상 비용: 약 500-1,000 엔/월

**비추천:**
- 24시간 계속 실행 (월 3,000 엔 이상)
- 사용하지 않는데 실행 상태로 방치

**이유:**
- RDS는 실행 시간에 비례하여 비용 발생
- 중지해도 스토리지 비용(약 345 엔/월)만 발생
- 필요 시에만 실행하면 비용을 크게 절감 가능

#### 2.4 환경 구성 권장 사항 (의견)

**소규모 팀 (1-2명):**
```
로컬 환경 → 스테이징 환경 → 프로덕션 환경
```
- IT 환경 불필요
- 비용: 0 엔/월

**중규모 팀 (3명 이상):**
```
로컬 환경 → IT 테스트 환경 → 스테이징 환경 → 프로덕션 환경
```
- IT 환경 권장
- 비용: 약 500-1,000 엔/월 (필요 시만 실행)

**이유:**
- 팀 규모가 커질수록 통합 테스트의 중요성 증가
- 여러 개발자가 동시에 작업할 때 공유 테스트 환경 필요
- CI/CD 파이프라인 구축 시 IT 환경 필수

#### 2.5 구축 시간 예상 (의견)

**예상 시간: 약 4-6시간**

**포함 작업:**
- AWS RDS 인스턴스 생성 및 설정
- 환경 변수 설정
- 관리 패널 연동
- 테스트 및 검증

**이유:**
- AWS RDS 인스턴스 생성: 약 1-2시간 (대기 시간 포함)
- 환경 설정 및 연동: 약 1-2시간
- 테스트 및 검증: 약 1-2시간

---

### 3. 결론에 도달한 근거

#### 3.1 IT 환경 필요성 근거

**사실 기반:**
- 로컬 환경은 통합 테스트에 한계가 있음 (표 1.1 참조)
- CI/CD 파이프라인은 공유 테스트 환경 필요
- 프로덕션 배포 전 검증은 실제 환경과 유사한 조건에서 수행해야 함

**의견:**
- 개발자 3명 이상의 팀에서는 IT 환경 구축을 권장
- 통합 테스트와 CI/CD 자동화가 중요한 프로젝트에서는 필수

#### 3.2 비용 근거

**사실 기반:**
- AWS RDS db.t3.micro 24시간 실행 시: 약 3,560 엔/월
- 필요 시만 실행 시: 약 500-1,000 엔/월
- AWS 프리 티어: 12개월간 무료 (750시간/월 이내)

**의견:**
- 필요 시만 실행하는 방식이 비용 효율적
- 프리 티어 활용 시 초기 12개월은 무료로 사용 가능
- 24시간 계속 실행은 비추천 (비용 낭비)

#### 3.3 환경 구성 권장 근거

**사실 기반:**
- 소규모 팀(1-2명)은 로컬 환경만으로도 충분한 경우가 많음
- 중규모 팀(3명 이상)은 통합 테스트 환경이 필요

**의견:**
- 팀 규모와 프로젝트 복잡도에 따라 환경 구성 결정
- 비용과 필요성의 균형을 고려하여 선택

---

## 참고사항

### 환경 변수 설정

IT 환경 제어를 위한 환경 변수:

```bash
# IT 환경 RDS 인스턴스 식별자
IT_RDS_INSTANCE_IDENTIFIER=namos-chat-it

# AWS 리전
AWS_REGION=ap-northeast-1
```

### 보안 고려사항

- IT 환경 제어는 SUPER_ADMIN 권한만 허용
- 프로덕션 또는 스테이징 환경에서만 제어 가능하도록 제한 권장
- AWS IAM 권한 적절히 설정 필요

---

**작성일:** 2025-01-27  
**작성자:** 프로젝트 팀  
**검토 필요:** 인프라 담당자, 프로젝트 관리자



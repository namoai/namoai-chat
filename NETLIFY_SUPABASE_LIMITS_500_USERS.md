# 📊 Netlify Pro + Supabase Pro: 500명 사용자 제한 확인

## 📈 500명 사용자 기준 사용량 계산

### 사용자 분포
- **총 사용자**: 500명
- **활성 사용자 (30%)**: 500명 × 30% = **150명**
- **일반 사용자 (80%)**: 150명 × 80% = 120명
- **헤비 유저 (20%)**: 150명 × 20% = 30명

### 월간 메시지 수
- **일반 사용자**: 120명 × 6,000개/월 = 720,000개
- **헤비 유저**: 30명 × 15,000개/월 = 450,000개
- **총 메시지**: **1,170,000개/월**

---

## 🔹 Netlify Pro 플랜 제한 확인

### 1. Serverless Functions 제한

#### Netlify Pro 제한
- **무료 포함**: 2,000,000회/월
- **초과 시**: 125,000회당 $25

#### 500명 사용자 기준
- **함수 호출**: 1,170,000회/월 (메시지당 1회 호출 가정)
- **제한 대비**: 1,170,000 / 2,000,000 = **58.5%**
- **결과**: ✅ **제한 안 걸림** (여유 830,000회)

#### ⚠️ 주의사항
- 메시지당 함수 호출이 2회 이상이면 제한에 걸릴 수 있음
- 현재 구조: 채팅 메시지 1회 = 함수 1회 호출
- **안전 마진**: 약 1,700명까지 가능 (함수 호출 1회 기준)

---

### 2. Bandwidth (대역폭) 제한

#### Netlify Pro 제한
- **무료 포함**: 1TB/월 (1,000GB)
- **초과 시**: GB당 과금

#### 500명 사용자 기준

##### 최적화 전 (최악의 경우)
- **텍스트 응답**: 1,170,000 × 5KB = 5.85GB
- **이미지 트래픽**: 1,170,000 × 1.5장 × 1MB = **1,755GB (1.76TB)**
- **총 대역폭**: 약 **1.76TB** → ❌ **1TB 초과!**

##### 최적화 후 (추천)
- **WebP 변환**: 1.76TB × 0.7 = 1.23TB (30% 감소)
- **응답형 이미지**: 1.23TB × 0.6 = 0.74TB (모바일 60% 가정, 평균 40% 감소)
- **브라우저 캐시**: 0.74TB × 0.4 = **0.30TB** (60% 캐시 히트)
- **총 대역폭**: 약 **0.30TB (300GB)** → ✅ **1TB 이내**

#### 결과
- **최적화 없음**: ❌ 제한 초과 (월 760GB 추가 비용)
- **최적화 있음**: ✅ 제한 안 걸림 (여유 700GB)

---

### 3. Build 시간 제한

#### Netlify Pro 제한
- **무료 포함**: 1,000분/월
- **초과 시**: 500분당 $7

#### 500명 사용자 기준
- **월간 빌드**: 10회 (배포 시)
- **평균 빌드 시간**: 5분
- **총 빌드 시간**: 50분/월
- **제한 대비**: 50 / 1,000 = **5%**
- **결과**: ✅ **제한 안 걸림** (여유 950분)

---

### 4. 함수 실행 시간 제한

#### Netlify Pro 제한
- **동기 함수**: 최대 30초
- **백그라운드 함수**: 최대 15분

#### 500명 사용자 기준
- **채팅 API**: 최대 30초 (현재 설정)
- **일반 응답 시간**: 2~5초
- **결과**: ✅ **제한 안 걸림**

---

## 🔹 Supabase Pro 플랜 제한 확인

### 1. 데이터베이스 스토리지

#### Supabase Pro 제한
- **무료 포함**: 100GB
- **초과 시**: GB당 $0.021

#### 500명 사용자 기준
- **캐릭터 이미지**: 약 5GB (캐릭터 500체 × 평균 10MB)
- **채팅 기록**: 약 2GB (1,170,000 메시지 × 평균 2KB)
- **벡터 데이터**: 약 1GB (embedding 데이터)
- **기타 데이터**: 약 1GB
- **총 스토리지**: 약 **9GB** → ✅ **100GB 이내**

---

### 2. 데이터 전송 (Egress)

#### Supabase Pro 제한
- **무료 포함**: 200GB/월
- **초과 시**: GB당 $0.09

#### 500명 사용자 기준 (이미지 최적화 후)
- **이미지 전송**: 300GB/월 (Netlify 대역폭과 동일)
- **데이터베이스 쿼리**: 약 10GB/월
- **총 전송량**: 약 **310GB/월** → ❌ **200GB 초과!**

#### 추가 비용 계산
- **초과량**: 310GB - 200GB = **110GB**
- **추가 비용**: 110GB × $0.09 = **$9.90/월 (약 1,485엔)**

---

### 3. API 요청

#### Supabase Pro 제한
- **무료 포함**: 무제한 (PostgreSQL 연결 풀 제한만 있음)

#### 500명 사용자 기준
- **데이터베이스 쿼리**: 1,170,000회/월 (메시지당 1회)
- **결과**: ✅ **제한 없음**

---

## 📊 종합 결과: 500명 사용자 기준

### Netlify Pro 플랜

| 항목 | 제한 | 사용량 | 상태 | 비고 |
|------|------|--------|------|------|
| **Serverless Functions** | 2,000,000회/월 | 1,170,000회 | ✅ 안전 | 여유 830,000회 |
| **Bandwidth (최적화 전)** | 1TB/월 | 1.76TB | ❌ 초과 | 추가 비용 $760/월 |
| **Bandwidth (최적화 후)** | 1TB/월 | 0.30TB | ✅ 안전 | 여유 700GB |
| **Build 시간** | 1,000분/월 | 50분 | ✅ 안전 | 여유 950분 |
| **함수 실행 시간** | 30초 | 2~5초 | ✅ 안전 | - |

### Supabase Pro 플랜

| 항목 | 제한 | 사용량 | 상태 | 추가 비용 |
|------|------|--------|------|-----------|
| **스토리지** | 100GB | 9GB | ✅ 안전 | 0엔 |
| **데이터 전송** | 200GB/월 | 310GB/월 | ❌ 초과 | **1,485엔/월** |
| **API 요청** | 무제한 | 1,170,000회 | ✅ 안전 | 0엔 |

---

## ✅ 최종 결론: 500명까지 가능한가?

### 조건부 가능: **이미지 최적화 필수!**

#### ✅ 제한 안 걸리는 항목
1. **Netlify Serverless Functions**: ✅ 안전 (58.5% 사용)
2. **Netlify Build 시간**: ✅ 안전 (5% 사용)
3. **Supabase 스토리지**: ✅ 안전 (9% 사용)
4. **Supabase API 요청**: ✅ 안전 (제한 없음)

#### ⚠️ 주의가 필요한 항목
1. **Netlify Bandwidth**: 
   - 최적화 없음: ❌ **1.76TB** (초과 760GB)
   - 최적화 있음: ✅ **0.30TB** (안전)
   
2. **Supabase 데이터 전송**:
   - 최적화 없음: ❌ **1.76TB** (초과 1,560GB, 월 14만엔!)
   - 최적화 있음: ❌ **310GB** (초과 110GB, 월 **1,485엔**)

---

## 💰 500명 사용자 기준 월간 비용

### 시나리오 A: 최적화 없음 (비현실적)
- Netlify Bandwidth 초과: **$760/월 (114,000엔)**
- Supabase 전송 초과: **$140.4/월 (21,060엔)**
- **총 추가 비용**: **월 135,060엔** → ❌ **비현실적**

### 시나리오 B: 이미지 최적화 적용 (추천) ✅
- Netlify Bandwidth: **0엔** (1TB 이내)
- Supabase 전송 초과: **$9.90/월 (1,485엔)**
- **총 추가 비용**: **월 1,485엔** → ✅ **현실적**

---

## 🎯 추천 전략

### 500명까지 유지하려면

#### 1. **이미지 최적화 필수** (Must Have)
- ✅ WebP 형식 변환 (30% 감소)
- ✅ 응답형 이미지 (4사이즈 생성)
- ✅ 브라우저 캐시 활용 (Cache-Control: max-age=31536000)

#### 2. **Supabase 전송 비용 최소화**
- ✅ Cloudflare R2로 이미지 이동 (전송비 0엔)
- ✅ 또는 Supabase Storage 최적화

#### 3. **모니터링**
- ✅ Netlify 대시보드에서 함수 호출 수 모니터링
- ✅ Supabase 대시보드에서 전송량 모니터링
- ✅ 월간 사용량 알림 설정

---

## 📈 500명 이후 경고선

### 700명 사용자 기준 (예상)
- **함수 호출**: 1,638,000회/월 → ✅ 여전히 안전 (82% 사용)
- **대역폭 (최적화 후)**: 0.42TB → ✅ 여전히 안전
- **Supabase 전송**: 434GB → ❌ **초과 234GB** (월 3,150엔)

### 1,000명 사용자 기준
- **함수 호출**: 2,340,000회/월 → ❌ **초과 340,000회** (월 $68 추가)
- **대역폭 (최적화 후)**: 0.60TB → ✅ 여전히 안전
- **Supabase 전송**: 620GB → ❌ **초과 420GB** (월 5,670엔)

---

## ✅ 최종 답변

### Q: 500명까지는 Netlify Pro + Supabase Pro로 제한에 안 걸리는가?

**A: 조건부 가능 (이미지 최적화 필수)**

#### ✅ 제한 안 걸리는 항목
- Netlify Serverless Functions: ✅ 안전
- Netlify Build 시간: ✅ 안전
- Supabase 스토리지: ✅ 안전

#### ⚠️ 주의 필요 항목
- **Netlify Bandwidth**: 이미지 최적화 없으면 ❌ 초과 (월 11만엔)
- **Supabase 전송**: 이미지 최적화 없으면 ❌ 초과 (월 2만엔)
- **Supabase 전송 (최적화 후)**: ⚠️ 초과 110GB (월 **1,485엔**)

#### 🎯 결론
1. **이미지 최적화 필수**: WebP + 응답형 + 캐시
2. **Supabase 전송 비용**: 월 1,485엔 발생 (수용 가능)
3. **500명까지 가능**: ✅ **가능** (이미지 최적화 전제)
4. **700명 이상**: ⚠️ Supabase 전송 비용 급증 (R2 이전 검토 필요)

---

## 💡 권장사항

### 500명까지
- ✅ **Netlify Pro + Supabase Pro 유지**
- ✅ **이미지 최적화 즉시 적용**
- ✅ **월 1,485엔 추가 비용 수용**

### 700명 이상
- ⚠️ **Cloudflare R2로 이미지 이동 검토**
- ⚠️ **Supabase 전송 비용 모니터링**
- ⚠️ **AWS 이전 준비 시작**

---

**결론: 500명까지는 가능하지만, 이미지 최적화는 필수입니다!** 🎯


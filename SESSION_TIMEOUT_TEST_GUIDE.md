# 🔍 세션 타임아웃 테스트 가이드

## 📋 테스트 방법

### 방법 1: 환경 변수 사용 (권장)

개발 환경에서 타임아웃 시간을 짧게 설정하여 빠르게 테스트할 수 있습니다.

#### 1. `.env.local` 파일에 추가

프로젝트 루트에 `.env.local` 파일을 만들거나 수정:

```bash
# 세션 타임아웃 테스트용 (30초)
NEXT_PUBLIC_SESSION_TIMEOUT_MS=30000

# 또는 1분으로 테스트
# NEXT_PUBLIC_SESSION_TIMEOUT_MS=60000

# 또는 2분으로 테스트
# NEXT_PUBLIC_SESSION_TIMEOUT_MS=120000
```

#### 2. 개발 서버 재시작

```bash
npm run dev
```

#### 3. 테스트 절차

1. 로그인
2. **아무 활동도 하지 않고** 설정한 시간만큼 대기
3. 자동으로 로그아웃되고 로그인 페이지로 리다이렉트되는지 확인

---

### 방법 2: 브라우저 개발자 도구 사용

브라우저 콘솔에서 직접 테스트할 수 있습니다.

#### 1. 개발자 도구 열기 (F12)

#### 2. 콘솔에서 다음 명령 실행

```javascript
// 현재 타임아웃 시간 확인
console.log('Current timeout:', 30 * 60 * 1000, 'ms (30분)');

// 테스트: 마지막 활동 시간을 30분 전으로 설정 (주의: 실제로는 작동하지 않음)
// 이 방법은 코드 수정이 필요합니다
```

#### 3. 코드 수정하여 테스트

`src/hooks/useSessionTimeout.ts` 파일에서 임시로 타임아웃 시간 변경:

```typescript
// 테스트용: 30초
const INACTIVITY_TIMEOUT = 30 * 1000; // 30초
```

테스트 후 원래대로 복구:
```typescript
const INACTIVITY_TIMEOUT = 30 * 60 * 1000; // 30분
```

---

### 방법 3: 탭 전환 테스트

탭 전환 시 타임아웃이 작동하는지 테스트:

1. 로그인
2. 다른 탭으로 전환
3. 30분 이상 대기 (또는 테스트용으로 짧게 설정)
4. 다시 사이트 탭으로 돌아오기
5. 자동 로그아웃되는지 확인

---

## ✅ 테스트 체크리스트

### 기본 기능 테스트
- [ ] 30분 비활성 시 자동 로그아웃
- [ ] 로그인 페이지로 리다이렉트
- [ ] 타임아웃 메시지 표시

### 활동 감지 테스트
- [ ] 마우스 움직임으로 타이머 리셋
- [ ] 키보드 입력으로 타이머 리셋
- [ ] 클릭으로 타이머 리셋
- [ ] 스크롤로 타이머 리셋

### 탭 전환 테스트
- [ ] 다른 탭으로 전환 후 30분 후 복귀 시 로그아웃
- [ ] 탭 전환 후 짧은 시간 내 복귀 시 로그인 유지

### 로그인 상태 유지 테스트
- [ ] "로그인 상태 유지" 체크 시에도 30분 비활성 시 로그아웃
- [ ] 브라우저를 닫았다가 다시 열었을 때 로그인 상태 유지 (30일 이내)

---

## 🛠️ 빠른 테스트 설정

### 30초 타임아웃으로 테스트

`.env.local`:
```bash
NEXT_PUBLIC_SESSION_TIMEOUT_MS=30000
```

### 1분 타임아웃으로 테스트

`.env.local`:
```bash
NEXT_PUBLIC_SESSION_TIMEOUT_MS=60000
```

### 5분 타임아웃으로 테스트

`.env.local`:
```bash
NEXT_PUBLIC_SESSION_TIMEOUT_MS=300000
```

---

## ⚠️ 주의사항

1. **프로덕션 배포 전 확인**: `.env.local` 파일은 Git에 커밋되지 않지만, 환경 변수 설정을 확인하세요.

2. **테스트 후 복구**: 테스트가 끝나면 `.env.local`에서 `NEXT_PUBLIC_SESSION_TIMEOUT_MS`를 제거하거나 주석 처리하세요.

3. **브라우저 캐시**: 변경사항이 반영되지 않으면 브라우저 캐시를 지우고 하드 리프레시(Ctrl+Shift+R)를 시도하세요.

---

## 🐛 문제 해결

### 타임아웃이 작동하지 않는 경우

1. **환경 변수 확인**: `.env.local` 파일이 올바른 위치에 있는지 확인
2. **서버 재시작**: 환경 변수 변경 후 개발 서버를 재시작
3. **콘솔 로그 확인**: 브라우저 개발자 도구 콘솔에서 에러 확인
4. **세션 상태 확인**: 로그인이 제대로 되어 있는지 확인

### 타임아웃이 너무 빠르게 발생하는 경우

- 환경 변수가 설정되어 있는지 확인
- 프로덕션 환경에서는 환경 변수를 설정하지 않도록 주의

---

**작성일**: 2025-01-27  
**버전**: 1.0



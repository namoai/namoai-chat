# E2E 테스트 스킵 원인 분석 (2025-12-24)

## 스킵된 테스트 목록 (10개)

---

## 1. `1-1-1: メールアドレス 회원가입`

### 스킵 원인
- **타입**: 기능상 제약
- **이유**: 이메일 인증이 필요함 (실제 이메일 발송)
- **코드 위치**: `e2e/user-auth.spec.ts:33` - `test.skip()` 처리됨

### 분석
- 회원가입 자체는 정상 작동하지만, 이메일 인증 코드 입력이 필요
- E2E 테스트에서는 실제 이메일을 받을 수 없어 스킵 처리
- **기능 버그 아님**: 정상 동작 (이메일 인증은 보안상 필수)

### 해결 방안
- 테스트용 이메일 인증 API 사용
- 또는 이메일 인증을 스킵하는 테스트 모드 추가

---

## 2. `1-1-6: パスワード変更` ✅ (수정 완료)

### 스킵 원인
- **타입**: 조건부 스킵 (선택자 문제)
- **이유**: 패스워드 변경 링크/버튼을 찾지 못함
- **코드 위치**: `e2e/user-auth.spec.ts:210` - 조건부 스킵

### 분석
```typescript
if (!foundPasswordChange) {
  test.skip(true, 'パスワード変更機能が見つかりません。実装状況を確認してください。');
  return;
}
```

### 기능 구현 확인
- ✅ `/change-password` 페이지가 존재함 (`src/app/change-password/page.tsx`)
- ✅ API 엔드포인트가 구현되어 있음 (`/api/users/change-password`)
- ✅ 프로필 페이지(`/profile/[userId]`)의 케밥 메뉴(MoreVertical)에 "パスワード変更" 버튼이 있음
- ✅ `profile.hasPassword`가 true일 때만 표시됨

### 결론
- **기능 버그 가능성**: 없음 (선택자 문제였음)
- 프로필 페이지의 케밥 메뉴에서 접근해야 함

### 해결 방안
- ✅ 프로필 페이지로 이동
- ✅ 케밥 메뉴(MoreVertical) 버튼 클릭
- ✅ "パスワード変更" 메뉴 항목 클릭
- ✅ 테스트 수정 완료

---

## 3. `1-3-3: キャラクター編集`

### 스킵 원인
- **타입**: 조건부 스킵 (데이터 부족)
- **이유**: 편집할 캐릭터가 없음
- **코드 위치**: `e2e/user-character.spec.ts:267` - 조건부 스킵

### 분석
```typescript
const noCharacterMessage = page.getByText('作成したキャラクターがいません');
if (await noCharacterMessage.count() > 0) {
  test.skip(true, '編集可能なキャラクターが見つかりません。キャラクター作成テストを先に実行してください。');
  return;
}
```

### 상태
- `test.describe.serial`로 캐릭터 작성 테스트와 순차 실행 설정됨
- 캐릭터 작성 테스트가 성공했으므로, 다음 실행에서 편집 테스트가 실행될 예정
- **기능 버그 아님**: 정상 동작 (데이터 의존성)

### 해결 방안
- 캐릭터 작성 테스트와 함께 순차 실행 (이미 설정됨)

---

## 4. `1-3-5: キャラクタークローン`

### 스킵 원인
- **타입**: 조건부 스킵 (데이터 부족 또는 선택자 문제)
- **이유**: 클론할 캐릭터를 찾지 못함
- **코드 위치**: `e2e/user-character.spec.ts:456` - 조건부 스킵

### 분석
```typescript
if (await characterCard.count() === 0) {
  test.skip(true, 'クローン可能なキャラクターが見つかりません。');
  return;
}
```

또는

```typescript
if (await cloneMenuItem.count() === 0) {
  test.skip(true, 'クローンメニューが見つかりません。');
  return;
}
```

### 확인 필요
- 캐릭터 관리 페이지에 캐릭터가 있는지 확인
- 케밥 메뉴의 "コピーから新規作成" 메뉴 항목이 표시되는지 확인
- **기능 버그 가능성**: 메뉴 항목이 표시되지 않는다면 기능 버그일 수 있음

### 해결 방안
- 캐릭터 작성 후 클론 테스트 실행
- 케밥 메뉴 선택자 개선

---

## 5. `1-5-3: 出席チェック`

### 스킵 원인
- **타입**: 조건부 스킵 (선택자 문제)
- **이유**: 출석 체크 버튼을 찾지 못함
- **코드 위치**: `e2e/user-points.spec.ts:57` - 조건부 스킵

### 분석
```typescript
if (await attendanceButton.count() === 0) {
  test.skip(true, '出席チェックボタンが見つかりません。');
}
```

### 기능 구현 확인
- ✅ 출석 체크 버튼이 구현되어 있음 (`src/app/points/page.tsx:283-303`)
- ✅ 버튼 텍스트: "出席して30ポイントGET" 또는 "本日は出席済み"
- ✅ `handleAttendance` 함수가 구현되어 있음

### 결론
- **기능 버그 가능성**: 높음 (선택자 문제)
- 버튼 텍스트가 "出席チェック"가 아니라 "出席して30ポイントGET"이므로 선택자가 매칭되지 않음

### 해결 방안
- 선택자를 `button:has-text("出席して30ポイントGET")` 또는 `button:has-text("出席")`로 수정

---

## 6. `1-6-3: フォロー/アンフォロー`

### 스킵 원인
- **타입**: 조건부 스킵 (데이터 부족 또는 선택자 문제)
- **이유**: 팔로우 버튼을 찾지 못함
- **코드 위치**: `e2e/user-social.spec.ts:68` - 조건부 스킵

### 분석
```typescript
if (await followButton.count() === 0) {
  test.skip(true, 'フォローボタンが見つかりません。');
  return;
}
```

### 기능 구현 확인
- ✅ 팔로우 기능이 구현되어 있음 (`src/app/profile/[userId]/page.tsx:248-267`)
- ✅ `handleFollow` 함수가 구현되어 있음
- ❓ 버튼 텍스트가 "フォロー"인지 확인 필요
- ❓ 다른 사용자의 프로필 페이지에 접근 가능한지 확인 필요

### 결론
- **기능 버그 가능성**: 중간
- 다른 사용자의 프로필 페이지에 접근할 수 없거나, 자신의 프로필에서는 팔로우 버튼이 표시되지 않을 수 있음
- 또는 선택자 문제일 수 있음

### 해결 방안
- 프로필 페이지 구조 확인
- 팔로우 버튼 선택자 개선
- 테스트용 다른 사용자 ID 확인

---

## 7. `1-6-7: いいね機能`

### 스킵 원인
- **타입**: 조건부 스킵 (데이터 부족 또는 선택자 문제)
- **이유**: 캐릭터를 찾지 못하거나 좋아요 버튼을 찾지 못함
- **코드 위치**: `e2e/user-social.spec.ts:122` - 조건부 스킵

### 분석
```typescript
try {
  await clickFirstCharacter(page);
} catch (error) {
  test.skip(true, 'キャラクターが見つかりません。');
  return;
}

if (await likeButton.count() === 0) {
  test.skip(true, 'いいねボタンが見つかりません。');
}
```

### 기능 구현 확인
- ✅ 좋아요 기능이 구현되어 있을 것으로 보임 (Heart 아이콘 사용)
- ❓ 캐릭터 상세 페이지에서 좋아요 버튼의 정확한 위치와 선택자 확인 필요

### 결론
- **기능 버그 가능성**: 중간
- 좋아요 버튼이 구현되어 있지만 선택자가 잘못되었을 가능성
- 또는 버튼이 aria-label이나 다른 속성으로 식별되어야 할 수 있음

### 해결 방안
- 캐릭터 상세 페이지 구조 확인
- Heart 아이콘 버튼 선택자 개선
- `button:has(svg)` 또는 `button[aria-label*="like"]` 등으로 선택자 개선

---

## 8. `1-6-8: コメント作成`

### 스킵 원인
- **타입**: 조건부 스킵 (데이터 부족 또는 선택자 문제)
- **이유**: 캐릭터를 찾지 못하거나 댓글 입력란을 찾지 못함
- **코드 위치**: `e2e/user-social.spec.ts:180` - 조건부 스킵

### 분석
```typescript
try {
  await clickFirstCharacter(page);
} catch (error) {
  test.skip(true, 'キャラクターが見つかりません。');
  return;
}

if (await commentInput.count() === 0) {
  test.skip(true, 'コメント入力欄が見つかりません。');
}
```

### 기능 구현 확인
- ✅ 댓글 기능이 구현되어 있음 (`src/app/characters/[characterId]/page.tsx:79-274`)
- ✅ 댓글 입력란: `input[type="text"]` with `placeholder="コメントを追加..."`
- ✅ 댓글 작성 버튼: `button` with `Send` 아이콘

### 결론
- **기능 버그 가능성**: 중간 (선택자 문제)
- 댓글 입력란이 `input[type="text"]`이지만 placeholder가 "コメントを追加..."이므로 선택자가 매칭되지 않을 수 있음

### 해결 방안
- 댓글 입력란 선택자를 `input[placeholder*="コメント"]` 또는 `input[placeholder*="コメントを追加"]`로 수정
- 댓글 작성 버튼 선택자를 `button:has(svg)` 또는 `button[type="submit"]`로 수정

---

## 9. `1-7-2: 通知既読処理`

### 스킵 원인
- **타입**: 조건부 스킵 (데이터 부족)
- **이유**: 읽지 않은 알림이 없음
- **코드 위치**: `e2e/user-notifications.spec.ts:51` - 조건부 스킵

### 분석
```typescript
if (await unreadNotification.count() === 0) {
  test.skip(true, '未読の通知が見つかりません。');
}
```

### 상태
- 읽지 않은 알림이 없으면 스킵
- **기능 버그 아님**: 정상 동작 (데이터 의존성)

### 해결 방안
- 테스트용 알림 생성
- 또는 알림이 있을 때만 테스트 실행

---

## 10. `1-9-2: キャラクター通報`

### 스킵 원인
- **타입**: 조건부 스킵 (데이터 부족 또는 선택자 문제)
- **이유**: 캐릭터를 찾지 못하거나 신고 버튼을 찾지 못함
- **코드 위치**: `e2e/user-inquiries.spec.ts:92` - 조건부 스킵

### 분석
```typescript
try {
  await clickFirstCharacter(page);
} catch (error) {
  test.skip(true, 'キャラクターが見つかりません。');
  return;
}

if (await reportButton.count() === 0) {
  test.skip(true, '通報ボタンが見つかりません。');
}
```

### 기능 구현 확인
- ✅ 신고 기능이 구현되어 있음 (`src/app/characters/[characterId]/page.tsx:508-554`)
- ✅ `handleReportConfirm` 함수가 구현되어 있음
- ✅ API 엔드포인트가 구현되어 있음 (`/api/reports`)
- ❓ 신고 버튼이 케밥 메뉴 안에 있을 수 있음 (MoreVertical 아이콘)

### 결론
- **기능 버그 가능성**: 높음 (선택자 문제)
- 신고 버튼이 케밥 메뉴(MoreVertical) 안에 있을 가능성이 높음
- 테스트에서 케밥 메뉴를 열고 신고 메뉴 항목을 클릭해야 할 수 있음

### 해결 방안
- 캐릭터 상세 페이지 구조 확인
- 케밥 메뉴 열기 → 신고 메뉴 항목 클릭 로직 추가
- 또는 신고 버튼이 직접 표시되는 경우 선택자 개선

---

## 11. `1-11-2: お知らせ詳細確認`

### 스킵 원인
- **타입**: 조건부 스킵 (데이터 부족 또는 선택자 문제)
- **이유**: 공지사항을 찾지 못함
- **코드 위치**: `e2e/user-notices.spec.ts:51` - 조건부 스킵

### 분석
```typescript
if (await firstNotice.count() === 0) {
  test.skip(true, 'お知らせが見つかりません。');
}
```

### 기능 구현 확인
- ✅ 공지사항 상세 페이지가 구현되어 있음 (`src/app/notice/[noticeId]/page.tsx`)
- ✅ 공지사항 목록 페이지가 구현되어 있음 (`src/app/notice/page.tsx`)
- ✅ 공지사항은 `button`으로 렌더링되며 클릭 시 `/notice/${notice.id}`로 이동

### 결론
- **기능 버그 가능성**: 낮음 (데이터 의존성)
- 공지사항이 없으면 스킵되는 것이 정상
- 또는 선택자가 `a[href*="/notice/"]`가 아니라 `button`이므로 선택자 문제일 수 있음

### 해결 방안
- 선택자를 `button:has-text("...")` 또는 `button[onclick*="notice"]`로 수정
- 또는 공지사항이 있을 때만 테스트 실행

---

## 기능 버그 가능성 요약

### 높은 가능성 (선택자 문제로 추정) ⚠️
1. **`1-1-6: パスワード変更`** - MyPage에서 링크를 찾지 못함. `/change-password` 페이지는 존재함. 직접 `/change-password`로 이동하도록 수정 필요
2. **`1-5-3: 出席チェック`** - 버튼 텍스트가 "出席して30ポイントGET"인데 선택자가 "出席チェック"를 찾음. 선택자를 `button:has-text("出席して30ポイントGET")`로 수정 필요
3. **`1-9-2: キャラクター通報`** - 신고 버튼이 케밥 메뉴(MoreVertical) 안에 있음. 케밥 메뉴 열기 → "通報する" 클릭 로직 추가 필요

### 중간 가능성 (선택자 또는 데이터 문제)
4. **`1-6-3: フォロー/アンフォロー`** - 다른 사용자 프로필 접근 문제 또는 선택자 문제. 테스트용 다른 사용자 ID 확인 필요
5. **`1-6-7: いいね機能`** - 좋아요 버튼은 Heart 아이콘 버튼. 선택자를 `button:has(svg)` 또는 `button:has(Heart)`로 수정 필요
6. **`1-6-8: コメント作成`** - 댓글 입력란 placeholder가 "コメントを追加..."인데 선택자가 "コメント"만 찾음. 선택자를 `input[placeholder*="コメントを追加"]`로 수정 필요
7. **`1-3-5: キャラクタークローン`** - 클론 메뉴 항목 선택자 문제. 케밥 메뉴에서 "コピーから新規作成" 찾기 로직 개선 필요

### 낮은 가능성 (데이터 의존성)
8. **`1-11-2: お知らせ詳細確認`** - 공지사항이 없으면 스킵 (정상)

### 낮은 가능성 (데이터 의존성)
1. **`1-3-3: キャラクター編集`** - 캐릭터 작성 후 실행 필요 (순차 실행 설정됨)
2. **`1-7-2: 通知既読処理`** - 읽지 않은 알림이 없으면 스킵 (정상)
3. **`1-11-2: お知らせ詳細確認`** - 공지사항이 없으면 스킵 (정상)

### 기능상 제약
1. **`1-1-1: メールアドレス 회원가입`** - 이메일 인증 필요 (보안상 필수)

---

## 다음 단계

1. **기능 구현 여부 확인**
   - 각 기능이 실제로 구현되어 있는지 확인
   - 구현되어 있다면 선택자 개선

2. **테스트 데이터 준비**
   - 테스트용 캐릭터, 알림, 공지사항 등 준비

3. **선택자 개선**
   - 기능이 구현되어 있지만 선택자 문제로 스킵되는 경우 개선

---

## 참고

- [현재 상태](./E2E_TEST_CURRENT_STATUS.md)
- [최종 테스트 결과](./E2E_TEST_RESULTS_2025-12-24_FINAL.md)


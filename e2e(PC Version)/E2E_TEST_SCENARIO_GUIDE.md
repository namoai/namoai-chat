# E2Eテスト シナリオ作成ガイド

**作成日**: 2025年12月22日

---

## 📋 シナリオ作成の観点

E2Eテストのシナリオは、**ユーザー観点**と**管理者観点**の2つに分けて作成します。

---

## 👤 ユーザー観点のシナリオ

### 1. 認証・アカウント管理

#### シナリオ1-1: 新規ユーザー登録
- メールアドレス登録
- Googleアカウント登録
- プロフィール完成（ニックネーム、年齢など）

#### シナリオ1-2: ログイン
- メールアドレス・パスワードでログイン
- Googleアカウントでログイン
- ログイン後のリダイレクト確認

#### シナリオ1-3: パスワード変更
- 現在のパスワード確認
- 新しいパスワード設定
- 変更後のログイン確認

---

### 2. キャラクター探索・検索

#### シナリオ2-1: キャラクター検索
- ホームページから検索バーにアクセス
- キーワードで検索実行
- 検索結果の表示確認
- キャラクター詳細ページへの遷移

#### シナリオ2-2: キャラクター一覧閲覧
- キャラクター一覧ページにアクセス
- カテゴリーフィルターで絞り込み
- ソート機能（人気順、新着順など）
- ページネーション動作確認

#### シナリオ2-3: キャラクター詳細確認
- キャラクター詳細ページで情報表示確認
- 画像の表示・切り替え
- 説明・設定の表示確認

---

### 3. チャット機能

#### シナリオ3-1: チャット開始
- キャラクター詳細ページから「チャット開始」をクリック
- 新規チャットセッション作成
- 最初のメッセージ表示確認

#### シナリオ3-2: メッセージ送信・受信
- メッセージ入力
- 送信ボタンクリック
- 自分のメッセージ表示確認
- AI応答の受信確認（時間がかかる場合の待機処理）

#### シナリオ3-3: チャット履歴確認
- チャットリストページにアクセス
- 過去のチャット一覧表示
- チャットを選択して再開

#### シナリオ3-4: セーフティフィルター制約
- セーフティフィルターONの状態でOFFキャラクターにチャット試行
- エラーメッセージ表示確認
- セーフティフィルターOFFに変更して再試行

---

### 4. ポイント・決済機能

#### シナリオ4-1: ポイント残高確認
- ポイントページにアクセス
- 無料ポイント・有料ポイントの表示確認

#### シナリオ4-2: ポイントチャージ
- チャージボタンクリック
- 金額選択・入力
- 決済フロー（Stripe連携）の動作確認
- チャージ後の残高更新確認

#### シナリオ4-3: 出席チェック
- 出席チェックボタンクリック
- ポイント付与確認
- 既に出席済みの場合のエラーハンドリング

---

### 5. キャラクター作成・管理

#### シナリオ5-1: キャラクター作成
- キャラクター作成ページにアクセス
- 基本情報入力（名前、説明など）
- AI生成機能の使用（プロフィール生成、詳細設定生成など）
- 画像アップロード
- 公開設定選択
- 保存・作成完了確認

#### シナリオ5-2: キャラクター編集
- 自分のキャラクター管理ページにアクセス
- キャラクターを選択して編集
- 情報を変更して保存
- 変更が反映されることを確認

#### シナリオ5-3: キャラクター削除
- 自分のキャラクターを削除
- 確認ダイアログでの確認
- 削除後の一覧更新確認

---

### 6. ソーシャル機能

#### シナリオ6-1: プロフィール確認
- 自分のプロフィールページにアクセス
- プロフィール情報の表示確認
- 他ユーザーのプロフィール確認

#### シナリオ6-2: フォロー・アンフォロー
- 他ユーザーのプロフィールでフォローボタンクリック
- フォロー状態の確認
- アンフォローの動作確認

#### シナリオ6-3: いいね機能
- キャラクター詳細ページでいいねボタンクリック
- いいね状態の切り替え確認

#### シナリオ6-4: コメント機能
- キャラクター詳細ページでコメント入力
- コメント投稿
- コメント一覧への表示確認

---

### 7. 通知機能

#### シナリオ7-1: 通知一覧確認
- 通知ページにアクセス
- 通知一覧の表示確認
- 未読・既読の区別確認

#### シナリオ7-2: 通知既読処理
- 通知をクリックして既読にマーク
- 未読数の減少確認

---

### 8. ランキング・検索

#### シナリオ8-1: ランキング確認
- ランキングページにアクセス
- カテゴリー別ランキング表示
- ランキング順位の表示確認

---

### 9. お知らせ・ガイド

#### シナリオ9-1: お知らせ確認
- お知らせ一覧ページにアクセス
- お知らせ詳細の表示確認

#### シナリオ9-2: ガイド閲覧
- ガイドページにアクセス
- ガイド内容の表示確認

---

## 🛡️ 管理者観点のシナリオ

### 1. 管理画面へのアクセス

#### シナリオ1-1: 管理者ログイン
- 管理者アカウントでログイン
- 管理画面へのアクセス
- 権限確認（SUPER_ADMIN、MODERATOR、CHAR_MANAGERなど）

#### シナリオ1-2: 権限不足時のアクセス拒否
- 一般ユーザーで管理画面アクセス試行
- アクセス拒否・リダイレクト確認

---

### 2. ユーザー管理

#### シナリオ2-1: ユーザー一覧・検索
- ユーザー管理ページにアクセス
- ユーザー一覧の表示確認
- ニックネーム・メールアドレスで検索
- 検索結果の表示確認

#### シナリオ2-2: ユーザー権限変更
- ユーザー一覧で権限ドロップダウン選択
- 権限変更（USER → MODERATORなど）
- 変更が保存されることを確認

#### シナリオ2-3: ユーザー停止
- ユーザー停止ボタンクリック
- 停止期間選択（1日、3日、7日、1ヶ月など）
- 停止理由入力
- 停止実行確認
- 停止状態の表示確認（停止中バッジ）

#### シナリオ2-4: ユーザー停止解除
- 停止中ユーザーの停止解除
- 解除後の状態確認

#### シナリオ2-5: ユーザー情報編集
- ユーザー編集モーダルを開く
- 名前、ニックネーム、メールアドレス編集
- ポイント手動設定（無料ポイント・有料ポイント）
- 保存確認

#### シナリオ2-6: ユーザー削除
- ユーザー削除実行
- 確認ダイアログでの確認
- 削除後のキャラクター匿名化確認

---

### 3. キャラクター管理

#### シナリオ3-1: キャラクター一覧・検索
- キャラクター管理ページにアクセス
- 全キャラクター一覧の表示確認
- キャラクター名で検索
- 検索結果の表示確認

#### シナリオ3-2: キャラクター編集
- キャラクターを選択して編集
- 情報を変更（名前、説明、公開設定など）
- 保存確認
- 変更が反映されることを確認

#### シナリオ3-3: キャラクター削除
- キャラクター削除実行
- 確認ダイアログでの確認
- 削除後の一覧更新確認

#### シナリオ3-4: キャラクター公開設定変更
- 公開・非公開の切り替え
- 変更後の状態確認

---

### 4. お知らせ管理

#### シナリオ4-1: お知らせ一覧確認
- お知らせ管理ページにアクセス
- お知らせ一覧の表示確認

#### シナリオ4-2: お知らせ作成
- 新規お知らせ作成ボタンクリック
- タイトル・本文入力
- 公開設定選択
- 保存・作成完了確認
- ユーザー側での表示確認

#### シナリオ4-3: お知らせ編集
- 既存お知らせを選択して編集
- 内容変更
- 保存確認

#### シナリオ4-4: お知らせ削除
- お知らせ削除実行
- 削除後の一覧更新確認

---

### 5. ガイド管理

#### シナリオ5-1: ガイド一覧確認
- ガイド管理ページにアクセス
- ガイド一覧の表示確認

#### シナリオ5-2: ガイド作成
- 新規ガイド作成
- タイトル・内容入力
- 保存確認

#### シナリオ5-3: ガイド編集・削除
- 既存ガイドの編集
- ガイド削除

---

### 6. バナー管理

#### シナリオ6-1: バナー一覧確認
- バナー管理ページにアクセス
- バナー一覧の表示確認

#### シナリオ6-2: バナー作成・編集
- 新規バナー作成
- 画像アップロード
- リンク設定
- 表示順序設定
- 保存確認

---

### 7. 統計情報確認

#### シナリオ7-1: ダッシュボード統計確認
- 管理ダッシュボードにアクセス
- ユーザー数、キャラクター数、チャット数の表示確認
- ポイント消費量などの統計確認

---

### 8. 約款管理

#### シナリオ8-1: 約款一覧確認
- 約款管理ページにアクセス
- 約款一覧の表示確認

#### シナリオ8-2: 約款編集
- 約款内容の編集
- 保存確認

---

## 📝 シナリオ作成時の考慮事項

### 優先度の高いシナリオ

1. **認証フロー**（最優先）
   - ログイン・ログアウト
   - セッション管理

2. **主要機能**
   - キャラクター検索・チャット開始
   - メッセージ送信

3. **管理者機能**
   - ユーザー管理（検索、権限変更、停止）
   - キャラクター管理（検索、編集、削除）

### テストデータの準備

- テスト用ユーザーアカウント（一般ユーザー、管理者）
- テスト用キャラクター
- テスト用チャット履歴
- テスト用通知データ

### エラーハンドリングの検証

- 不正な入力値でのエラー表示
- 権限不足時のアクセス拒否
- ネットワークエラー時の動作
- セーフティフィルター制約時の動作

### クロスブラウザ対応

- Chrome
- Firefox
- Safari
- Edge

---

## 🎯 シナリオ作成の手順

1. **機能リストアップ**: 各観点（ユーザー/管理者）で実装されている機能をリストアップ
2. **シナリオ設計**: 各機能について正常系・異常系のシナリオを設計
3. **優先度付け**: 重要度・頻度に基づいて優先度を決定
4. **テストデータ準備**: 各シナリオで必要なテストデータを定義
5. **実行順序決定**: 依存関係を考慮してテスト実行順序を決定

---

**作成者**: 開発チーム  
**最終更新**: 2025年12月22日















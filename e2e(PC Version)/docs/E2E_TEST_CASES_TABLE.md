# E2E テストケース一覧表

**最終更新**: 2025年12月22日  
**対象環境**: develop環境（NAMOAIChat）

---

## 📊 テストケース概要

| カテゴリ | テストファイル | テスト数 | P0 | P1 | P2 |
|---------|--------------|---------|----|----|----|
| **ポイント関連（クリティカル）** | `points-critical.spec.ts` | 6 | 6 | 0 | 0 |
| **認証機能** | `user-auth.spec.ts` | 4 | 0 | 2 | 2 |
| **キャラクター機能** | `user-character.spec.ts` | 7 | 0 | 4 | 3 |
| **チャット機能** | `chat.spec.ts` | 4 | 0 | 3 | 1 |
| **ポイント・決済機能** | `user-points.spec.ts` | 3 | 0 | 2 | 1 |
| **ソーシャル機能** | `user-social.spec.ts` | 5 | 0 | 3 | 2 |
| **通知機能** | `user-notifications.spec.ts` | 3 | 0 | 2 | 1 |
| **ランキング機能** | `user-ranking.spec.ts` | 3 | 0 | 2 | 1 |
| **お問い合わせ・通報** | `user-inquiries.spec.ts` | 3 | 0 | 2 | 1 |
| **ペルソナ機能** | `user-persona.spec.ts` | 4 | 0 | 2 | 2 |
| **お知らせ・ガイド・約款** | `user-notices.spec.ts` | 4 | 0 | 2 | 2 |
| **管理者：ユーザー管理** | `admin-user-management.spec.ts` | 5 | 0 | 3 | 2 |
| **管理者：キャラクター管理** | `admin-character-management.spec.ts` | 4 | 0 | 3 | 1 |
| **管理者：お知らせ管理** | `admin-notices.spec.ts` | 2 | 0 | 2 | 0 |
| **管理者：通報管理** | `admin-reports.spec.ts` | 3 | 0 | 2 | 1 |
| **管理者：ガイド管理** | `admin-guides.spec.ts` | 2 | 0 | 2 | 0 |
| **管理者：バナー管理** | `admin-banners.spec.ts` | 2 | 0 | 2 | 0 |
| **管理者：約款管理** | `admin-terms.spec.ts` | 2 | 0 | 1 | 1 |
| **管理者：IP管理** | `admin-ip-management.spec.ts` | 3 | 0 | 2 | 1 |
| **その他機能** | `misc-features.spec.ts` | 3 | 0 | 2 | 1 |
| **合計** | **20ファイル** | **70** | **6** | **40** | **24** |

---

## 🔴 P0: クリティカルテスト（必須）

| ID | テストケース名 | テストファイル | 説明 |
|---|--------------|--------------|------|
| P0-1 | 新規登録/ログイン → 初期ポイント確認 → チャット1往復 → ポイント減少 | `points-critical.spec.ts` | ユーザー登録後、初期ポイントを確認し、チャット1往復でポイントが正しく減少することを確認 |
| P0-2 | 画像作成 → 生成成功 → ポイント減少（失敗時は減らない） | `points-critical.spec.ts` | 画像生成が成功した場合のみポイントが減少し、失敗時はポイントが減らないことを確認 |
| P0-3 | ポイント0でチャット不可 → 「ポイント購入が必要です」表示 + 購入導線 | `points-critical.spec.ts` | ポイントが0の状態でチャットを試みると、エラーメッセージと購入導線が表示されることを確認 |
| P0-4 | ポイント0で画像作成不可 → 同上 | `points-critical.spec.ts` | ポイントが0の状態で画像生成を試みると、エラーメッセージと購入導線が表示されることを確認 |
| P0-5 | 通信断/LLM失敗時 → エラー表示 + ポイント減らない + 再試行できる | `points-critical.spec.ts` | ネットワークエラーやLLM失敗時にエラーが表示され、ポイントが減らず、再試行できることを確認 |
| P0-6 | ログアウト→再ログインでキャラ/履歴/ポイント保持 | `points-critical.spec.ts` | ログアウト後、再ログイン時にキャラクター、チャット履歴、ポイントが保持されることを確認 |

---

## 🟡 P1: 重要テスト

### 認証機能 (`user-auth.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-1-1 | メールアドレス 회원가입 | メールアドレスで新規登録できることを確認 |
| 1-1-3 | メールアドレス 로그イン | 正しい認証情報でログインできることを確認 |

### キャラクター機能 (`user-character.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-2-1 | キャラクター検索 | キーワードでキャラクターを検索できることを確認 |
| 1-2-2 | キャラクター一覧確認 | キャラクター一覧が正しく表示されることを確認 |
| 1-2-3 | キャラクター詳細確認 | キャラクター詳細情報が正しく表示されることを確認 |
| 1-3-2 | キャラクター作成（手動入力） | 手動でキャラクターを作成できることを確認 |

### チャット機能 (`chat.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-4-1 | チャット開始（新規） | キャラクター詳細ページからチャットを開始できることを確認 |
| 1-4-2 | メッセージ送信・受信 | メッセージを送信し、AI応答を受信できることを確認 |
| 1-4-3 | チャット履歴確認 | 過去のチャット履歴が正しく表示されることを確認 |

### ポイント・決済機能 (`user-points.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-5-1 | ポイント残高確認 | ポイント残高が正しく表示されることを確認 |
| 1-5-3 | 出席チェック | 出席チェックでポイントが付与されることを確認 |

### ソーシャル機能 (`user-social.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-6-1 | 自分のプロフィール確認 | 自分のプロフィール情報が正しく表示されることを確認 |
| 1-6-3 | フォロー/アンフォロー | ユーザーをフォロー/アンフォローできることを確認 |
| 1-6-7 | いいね機能 | キャラクターにいいねできることを確認 |

### 通知機能 (`user-notifications.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-7-1 | 通知一覧確認 | 通知一覧が正しく表示されることを確認 |
| 1-7-2 | 通知既読処理 | 通知を既読にできることを確認 |

### ランキング機能 (`user-ranking.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-8-1 | リアルタイムランキング確認 | リアルタイムランキングが正しく表示されることを確認 |
| 1-8-2 | 日次/週次/月次ランキング確認 | 期間別ランキングが正しく表示されることを確認 |

### お問い合わせ・通報 (`user-inquiries.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-9-1 | お問い合わせ作成 | お問い合わせを作成できることを確認 |
| 1-9-2 | キャラクター通報 | キャラクターを通報できることを確認 |

### ペルソナ機能 (`user-persona.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-10-1 | ペルソナ一覧確認 | ペルソナ一覧が正しく表示されることを確認 |
| 1-10-2 | ペルソナ作成 | ペルソナを作成できることを確認 |

### お知らせ・ガイド・約款 (`user-notices.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-11-1 | お知らせ一覧確認 | お知らせ一覧が正しく表示されることを確認 |
| 1-11-2 | お知らせ詳細確認 | お知らせ詳細が正しく表示されることを確認 |

### 管理者機能

#### ユーザー管理 (`admin-user-management.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 2-2-1 | ユーザー一覧確認 | ユーザー一覧が正しく表示されることを確認 |
| 2-2-2 | ユーザー検索（メール/ID） | ユーザーを検索できることを確認 |
| 2-2-5 | ユーザー停止 | ユーザーを停止できることを確認 |

#### キャラクター管理 (`admin-character-management.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 2-3-1 | キャラクター一覧確認 | キャラクター一覧が正しく表示されることを確認 |
| 2-3-3 | キャラクター公開/非公開切替 | キャラクターの公開状態を変更できることを確認 |
| 2-3-7 | ナモアイフレンズ登録/解除 | 公式キャラクターとして登録/解除できることを確認 |

#### その他管理者機能

| ID | テストケース名 | テストファイル | 説明 |
|---|--------------|--------------|------|
| 2-4-1 | お知らせ一覧確認 | `admin-notices.spec.ts` | お知らせ一覧が正しく表示されることを確認 |
| 2-4-2 | お知らせ作成 | `admin-notices.spec.ts` | お知らせを作成できることを確認 |
| 2-8-1 | 通報一覧確認 | `admin-reports.spec.ts` | 通報一覧が正しく表示されることを確認 |
| 2-8-2 | 通報フィルタリング | `admin-reports.spec.ts` | 通報をフィルタリングできることを確認 |
| 2-5-1 | ガイド一覧確認 | `admin-guides.spec.ts` | ガイド一覧が正しく表示されることを確認 |
| 2-5-2 | ガイド作成 | `admin-guides.spec.ts` | ガイドを作成できることを確認 |
| 2-6-1 | バナー一覧確認 | `admin-banners.spec.ts` | バナー一覧が正しく表示されることを確認 |
| 2-6-2 | バナー作成 | `admin-banners.spec.ts` | バナーを作成できることを確認 |
| 2-7-1 | 約款一覧確認 | `admin-terms.spec.ts` | 約款一覧が正しく表示されることを確認 |
| 2-10-1 | IPブロック | `admin-ip-management.spec.ts` | IPをブロックできることを確認 |
| 2-10-2 | IPブロック解除 | `admin-ip-management.spec.ts` | IPブロックを解除できることを確認 |

### その他機能 (`misc-features.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 3-3-1 | チャット後ランキング反映確認 | チャット後、ランキングに反映されることを確認 |
| 3-5-1 | セーフティフィルターON時OFFキャラクターブロック | セーフティフィルターON時、OFFキャラクターとチャットできないことを確認 |

---

## 🟢 P2: 通常テスト

### 認証機能 (`user-auth.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-1-5 | ログアウト | ログアウトできることを確認 |
| 1-1-6 | パスワード変更 | パスワードを変更できることを確認 |

### キャラクター機能 (`user-character.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-2-4 | ブロックした作成者のキャラクター検索除外 | ブロックしたユーザーのキャラクターが検索結果に表示されないことを確認 |
| 1-3-3 | キャラクター編集 | キャラクター情報を編集できることを確認 |
| 1-3-5 | キャラクタークローン | 他ユーザーのキャラクターをクローンできることを確認 |

### チャット機能 (`chat.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-4-4 | チャットキャンセル | チャットをキャンセルできることを確認 |

### ポイント・決済機能 (`user-points.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-5-4 | ポイント使用確認 | チャットでポイントが使用されることを確認 |

### ソーシャル機能 (`user-social.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-6-2 | 他ユーザーのプロフィール確認 | 他ユーザーのプロフィールを確認できることを確認 |
| 1-6-8 | コメント作成 | コメントを作成できることを確認 |

### 通知機能 (`user-notifications.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-7-4 | 未読通知数確認 | 未読通知数が正しく表示されることを確認 |

### ランキング機能 (`user-ranking.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-8-3 | ランキングからキャラクターをクリック | ランキングからキャラクター詳細に移動できることを確認 |

### お問い合わせ・通報 (`user-inquiries.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-9-3 | 自分のお問い合わせ/通報一覧確認 | 自分のお問い合わせ/通報一覧を確認できることを確認 |

### ペルソナ機能 (`user-persona.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-10-3 | ペルソナ編集 | ペルソナを編集できることを確認 |
| 1-10-4 | ペルソナ削除 | ペルソナを削除できることを確認 |

### お知らせ・ガイド・約款 (`user-notices.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 1-11-3 | ガイド確認 | ガイドを確認できることを確認 |
| 1-11-4 | 約款確認 | 約款を確認できることを確認 |

### 管理者機能

#### ユーザー管理 (`admin-user-management.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 2-2-3 | ユーザー権限変更 | ユーザーの権限を変更できることを確認 |
| 2-2-4 | ユーザー情報編集 | ユーザー情報を編集できることを確認 |

#### キャラクター管理 (`admin-character-management.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 2-3-5 | キャラクター削除 | キャラクターを削除できることを確認 |

#### その他管理者機能

| ID | テストケース名 | テストファイル | 説明 |
|---|--------------|--------------|------|
| 2-7-2 | 約款編集 | `admin-terms.spec.ts` | 約款を編集できることを確認 |
| 2-8-4 | 通報状態変更 | `admin-reports.spec.ts` | 通報の状態を変更できることを確認 |
| 2-10-3 | IPモニタリング | `admin-ip-management.spec.ts` | IPアクセスをモニタリングできることを確認 |

### その他機能 (`misc-features.spec.ts`)

| ID | テストケース名 | 説明 |
|---|--------------|------|
| 3-12-2 | チャットノート機能 | チャットノートを作成できることを確認 |

---

## 自動化要件の対応状況

| 要件 | 対応状況 | 実装詳細 |
|------|---------|---------|
| **Playwright（TypeScript）で実装** | ✅ 完了 | すべてのテストがTypeScriptで実装済み |
| **テストID（data-testid）を優先** | ✅ 実装済み | フォールバックで`role`/`label`/`text`を使用 |
| **UI操作でログイン** | ✅ 実装済み | `loginUser`関数でUI操作によるログイン実装 |
| **ポイント残高の二重チェック** | ✅ 実装済み | `getPointsFromUI`と`getPointsFromAPI`で両方確認 |
| **画像作成のモック/スタブ** | ⚠️ 要実装 | 外部API（Replicate）が不安定な場合の対応が必要 |
| **失敗時のスクショ/動画/トレース保存** | ✅ 設定済み | `playwright.config.ts`で`on-first-retry`設定 |
| **READMEに実行方法** | ✅ 完了 | `e2e/README.md`にローカル/CI実行方法を記載 |
| **テストケース一覧（表）** | ✅ 完了 | 本ドキュメント（`docs/E2E_TEST_CASES_TABLE.md`） |

---

## 実行方法

### すべてのテストを実行

```bash
npm run test:e2e
```

### P0テストのみ実行

```bash
npm run test:e2e -- e2e/points-critical.spec.ts
```

### 特定のカテゴリを実行

```bash
# 認証機能のみ
npm run test:e2e -- e2e/user-auth.spec.ts

# 管理者機能のみ
npm run test:e2e -- e2e/admin-*.spec.ts
```

### UIモードで実行（デバッグ）

```bash
npm run test:e2e:ui
```

---

## 参考

- [P0テストシナリオ詳細](./E2E_TEST_SCENARIOS_P0.md)
- [E2Eテスト実行ガイド](../e2e/README.md)
- [テストシナリオ詳細（韓国語）](../E2E_TEST_SCENARIOS_KO.md)















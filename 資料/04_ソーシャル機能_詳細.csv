セクション,項目,内容,補足
UI基本設計書,機能名,ソーシャル機能,
,対象画面,ユーザープロフィール閲覧ページ,
,技術スタック,"Next.js 15, TypeScript, Prisma, PostgreSQL",
,作成日,2025-10-28,

1. 画面概要,プロフィール閲覧ページ,他ユーザーのプロフィールを閲覧。フォロー・アンフォロー・ブロック・ブロック解除機能付き。作成キャラクター一覧表示。,src/app/profile/[userId]/page.tsx
,フォロワー一覧,ユーザーのフォロワーを一覧表示。各フォロワーのプロフィールへのリンク。,
,フォロイング一覧,ユーザーがフォローしているユーザーを一覧表示。各ユーザーのプロフィールへのリンク。,
,ブロックリスト,ブロックしているユーザーを一覧表示。ブロック解除ボタン付き。本人のみ閲覧可能。,

2. 前提/制約,データ取得,プロフィール情報はサーバーサイドで取得。フォロー・フォロワー数も同時取得。,
,権限チェック,ブロックリストは本人のみ閲覧可能。他ユーザーがアクセスすると404表示。,
,ブロック制限,ブロックしたユーザーは相互にプロフィール閲覧不可。フォロー・コメント・チャットも不可。,
,相互フォロー,フォローは一方向。相互フォローも可能。,

3. 関連URL・遷移,/profile/[userId],ユーザープロフィール閲覧ページ,
,遷移フロー,"ユーザー検索 → プロフィール閲覧 → フォロー or ブロック",

4. 役割・権限,一般ユーザー,全てのソーシャル機能にアクセス可能。他ユーザーをフォロー・ブロック可能。,
,ブロックされたユーザー,ブロックしたユーザーのプロフィール閲覧不可。コメント・チャットも不可。,

5. 主要機能一覧,フォロー,他ユーザーをフォロー。フォロー数・フォロワー数を更新。,
,アンフォロー,フォロー中のユーザーをアンフォロー。フォロー数・フォロワー数を更新。,
,フォロワー一覧閲覧,ユーザーのフォロワーを一覧表示。各フォロワーのプロフィールへのリンク。,
,フォロイング一覧閲覧,ユーザーがフォローしているユーザーを一覧表示。各ユーザーのプロフィールへのリンク。,
,ブロック,他ユーザーをブロック。ブロックしたユーザーは相互にプロフィール閲覧不可。,
,ブロック解除,ブロック中のユーザーをブロック解除。再度プロフィール閲覧可能に。,
,ブロックリスト閲覧,ブロックしているユーザーを一覧表示。本人のみ閲覧可能。,
,プロフィール閲覧,他ユーザーのプロフィール情報・作成キャラクター一覧を閲覧。,
,作成キャラクター一覧,ユーザーが作成した公開キャラクターを一覧表示。非公開キャラクターは表示しない。,

6. 画面構成,プロフィールヘッダー,ユーザー画像・ニックネーム・自己紹介・フォロー数・フォロワー数を表示。,
,フォローボタン,フォロー/アンフォローを切り替え。本人の場合は非表示。,
,ブロックボタン,ブロック/ブロック解除を切り替え。本人の場合は非表示。確認ダイアログ付き。,
,作成キャラクター一覧,キャラクターカードをグリッドレイアウトで表示。公開キャラクターのみ。,
,フォロワー一覧,ユーザーカードをリスト形式で表示。各ユーザーのプロフィールへのリンク。,
,フォロイング一覧,ユーザーカードをリスト形式で表示。各ユーザーのプロフィールへのリンク。,
,ブロックリスト,ユーザーカードをリスト形式で表示。ブロック解除ボタン付き。,

7. 画面項目定義,項目名（プロフィール）,型,必須,バリデーション,備考
,ユーザーID,string,必須,URLパラメータ,
,ニックネーム,string,必須,1〜50文字,
,プロフィール画像,string,任意,画像URL,
,自己紹介,string,任意,最大500文字,
,フォロー数,number,必須,0以上,
,フォロワー数,number,必須,0以上,
,作成日,date,必須,ISO 8601形式,

8. フィルタ仕様,ブロックフィルター,ブロックしたユーザーのプロフィールは404表示。ブロックされたユーザーも404表示。,
,公開設定フィルター,作成キャラクター一覧は公開キャラクターのみ表示。非公開キャラクターは表示しない。,

9. API I/F 仕様,エンドポイント,メソッド,パラメータ,レスポンス,説明
,/api/profile/[userId],GET,パスなし,"{ user: { id, nickname, image, bio, followersCount, followingCount, createdAt }, isFollowing, isBlocked }",ユーザープロフィール取得API
,/api/profile/[userId]/follow,POST,パスなし,"{ success, isFollowing }",フォロー/アンフォローAPI（トグル）
,/api/profile/[userId]/followers,GET,"{ page?, limit? }","{ followers: [], total }",フォロワー一覧取得API
,/api/profile/[userId]/following,GET,"{ page?, limit? }","{ following: [], total }",フォロイング一覧取得API
,/api/profile/[userId]/block,POST,パスなし,"{ success, isBlocked }",ブロック/ブロック解除API（トグル）
,/api/profile/[userId]/blocked-users,GET,"{ page?, limit? }","{ blockedUsers: [], total }",ブロックリスト取得API（本人のみ）

10. エラー・通知文言,エラータイプ,文言,表示タイミング
,ブロックエラー,このユーザーのプロフィールは閲覧できません。,ブロックされたユーザーのプロフィールアクセス時
,権限エラー,ブロックリストは本人のみ閲覧できます。,他ユーザーのブロックリストアクセス時
,成功メッセージ,フォローしました。,フォロー成功時
,成功メッセージ,フォローを解除しました。,アンフォロー成功時
,成功メッセージ,ブロックしました。,ブロック成功時
,成功メッセージ,ブロックを解除しました。,ブロック解除成功時
,ブロック確認,このユーザーをブロックしてもよろしいですか？相互にプロフィール閲覧・コメント・チャットができなくなります。,ブロックボタン押下時

11. モーダル仕様,モーダル名,トリガー,内容,ボタン
,ブロック確認モーダル,ブロックボタン押下時,ブロック確認メッセージ。ブロックの影響を説明。,キャンセル・ブロック
,ブロック解除確認,ブロック解除ボタン押下時,ブロック解除確認メッセージ。,キャンセル・解除
,フォロワー一覧モーダル,フォロワー数クリック時,フォロワーを一覧表示。各フォロワーのプロフィールへのリンク。,閉じる
,フォロイング一覧モーダル,フォロー数クリック時,フォロイングを一覧表示。各ユーザーのプロフィールへのリンク。,閉じる

12. 認証/ガード,認証チェック,ソーシャル機能はログイン必須。未ログインなら/loginへリダイレクト。,
,権限チェック,ブロックリストは本人のみ閲覧可能。他ユーザーがアクセスすると404表示。,
,ブロックチェック,ブロックしたユーザーまたはブロックされたユーザーのプロフィールは404表示。,

13. 非機能要件,パフォーマンス,フォロー・フォロワー数はキャッシュ。フォロー・ブロック操作は非同期処理。,
,セキュリティ,ブロック情報は他ユーザーに非公開。APIアクセス制限。,
,スケーラビリティ,フォロー・ブロック関係はインデックス最適化。大量フォロワーにも対応。,
,可用性,API失敗時はリトライ機能。エラー時は適切なエラーメッセージ表示。,

14. テスト観点,項目,テストケース
,フォロー,正常系：フォローボタンでフォロー成功・フォロー数更新確認
,アンフォロー,正常系：アンフォローボタンでアンフォロー成功・フォロー数更新確認
,ブロック,正常系：ブロックボタンでブロック成功・相互プロフィール閲覧不可確認
,ブロック解除,正常系：ブロック解除ボタンで解除成功・プロフィール閲覧可能確認
,フォロワー一覧,フォロワー一覧表示・各フォロワーのプロフィールへのリンク動作確認
,フォロイング一覧,フォロイング一覧表示・各ユーザーのプロフィールへのリンク動作確認
,ブロックリスト,本人のブロックリスト閲覧可能・他ユーザーは404表示確認
,ブロック制限,ブロックされたユーザーのプロフィール閲覧不可確認
,作成キャラクター一覧,公開キャラクターのみ表示・非公開キャラクターは非表示確認

15. 今後の拡張余地,項目,提案内容
,ミュート機能,特定ユーザーの投稿を非表示にする機能
,フォローリクエスト,プライベートアカウントのフォローリクエスト機能
,フォロー通知,フォローされた時の通知機能
,相互フォロー表示,相互フォローのユーザーを明示的に表示
,フォローレコメンデーション,おすすめユーザーの提案
,ソーシャルアクティビティフィード,フォローしているユーザーの活動を表示


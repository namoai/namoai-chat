大分類,中分類,項目,詳細内容
━━━ UI基本設計書 ━━━,,,
基本情報,機能名,ペルソナシステム,
,対象画面,ペルソナ作成/編集ページ ・ ペルソナ一覧ページ,
,技術スタック,Next.js 15 ・ TypeScript ・ Prisma ・ PostgreSQL,
,作成日,2025-10-28,
━━━ 1. 画面概要 ━━━,,,
ペルソナ一覧ページ,機能,ペルソナ管理,ユーザーが作成したペルソナを一覧表示 ・ デフォルトペルソナ設定・編集・削除機能付き
,ファイル,src/app/persona/list/page.tsx,
ペルソナ作成/編集ページ,機能,ペルソナ編集,新しいペルソナを作成または既存ペルソナを編集 ・ 名前・説明・性格・口調などを設定
,ファイル,src/app/persona/form/[[...personaId]]/page.tsx,
━━━ 2. 前提・制約 ━━━,,,
データ取得,方式,サーバーサイド取得 ・ ログインユーザーのペルソナのみ表示,
デフォルトペルソナ,設定,ユーザーは1つのペルソナをデフォルトに設定可能 ・ チャット時に自動適用,
ペルソナ数制限,制限なし,無制限にペルソナを作成可能 ・ ただし実用的には10個程度を推奨,
チャット適用,適用方式,チャット開始時にペルソナを選択可能 ・ デフォルトペルソナが自動選択される,
━━━ 3. 関連URL・遷移 ━━━,,,
URL一覧,/persona/list,ペルソナ一覧ページ,
,/persona/form,ペルソナ作成ページ,
,/persona/form/[personaId],ペルソナ編集ページ,
遷移フロー,基本フロー,ペルソナ一覧 → 作成/編集 → 保存 → 一覧に戻る,
━━━ 4. 役割・権限 ━━━,,,
一般ユーザー,操作権限,全てのペルソナ機能にアクセス可能 ・ 自分のペルソナのみ作成・編集・削除可能,
━━━ 5. 主要機能一覧 ━━━,,,
ペルソナ作成,作成機能,名前・説明・性格・口調・背景などを設定して新規ペルソナを作成,
ペルソナ編集,編集機能,既存ペルソナの全ての情報を編集可能,
ペルソナ削除,削除機能,ペルソナを完全削除 ・ 確認ダイアログ付き ・ デフォルトペルソナの場合は警告表示,
デフォルトペルソナ設定,設定機能,1つのペルソナをデフォルトに設定 ・ チャット時に自動適用,
ペルソナ一覧閲覧,一覧表示,ユーザーが作成した全てのペルソナを一覧表示 ・ デフォルトペルソナをバッジで表示,
チャット時のペルソナ適用,AI連携,チャット開始時にペルソナを選択 ・ 選択したペルソナの設定がAI応答に反映,
━━━ 6. 画面構成（UIブロック） ━━━,,,
ペルソナ一覧テーブル,テーブル表示,ペルソナ名 ・ 説明（抜粋） ・ デフォルトバッジ ・ 編集ボタン ・ 削除ボタンを表示,
デフォルトバッジ,バッジ表示,デフォルトペルソナに「デフォルト」バッジを表示,
ペルソナ作成ボタン,操作ボタン,ペルソナ一覧の上部に配置 ・ クリックでペルソナ作成ページへ遷移,
ペルソナ作成フォーム,入力フォーム,名前 ・ 説明 ・ 性格 ・ 口調 ・ 背景 ・ その他のメモを入力 ・ 保存ボタン・キャンセルボタン,
デフォルト設定チェックボックス,設定欄,ペルソナ作成/編集時にデフォルトに設定するチェックボックス,
━━━ 7. 画面項目定義 ━━━,,,
【ペルソナ】ペルソナ名,型: string,必須 ・ 1〜100文字,
【ペルソナ】説明,型: string,任意 ・ 最大500文字,ペルソナの簡単な説明
【ペルソナ】性格,型: string,任意 ・ 最大1000文字,性格設定（明るい・内向的など）
【ペルソナ】口調,型: string,任意 ・ 最大500文字,話し方の特徴（丁寧語・タメ口など）
【ペルソナ】背景,型: string,任意 ・ 最大1000文字,背景設定（職業・趣味など）
【ペルソナ】その他のメモ,型: string,任意 ・ 最大2000文字,自由記述欄
【ペルソナ】デフォルト設定,型: boolean,任意 ・ true / false,デフォルトペルソナに設定するか
━━━ 8. フィルタ仕様 ━━━,,,
デフォルトフィルター,表示順序,デフォルトペルソナを一覧の最初に表示,
━━━ 9. API I/F 仕様 ━━━,,,
GET /api/persona,パラメータ,クエリなし,レスポンス: { personas: [] } ・ ペルソナ一覧取得API（ログインユーザーのペルソナのみ）
POST /api/persona,パラメータ,{ name ・ description ・ personality ・ tone ・ background ・ notes ・ isDefault },レスポンス: { success ・ personaId } ・ ペルソナ作成API
GET /api/persona/[personaId],パラメータ,パスなし,レスポンス: { persona: { id ・ name ・ description ・ personality ・ tone ・ background ・ notes ・ isDefault } } ・ ペルソナ詳細取得API
PUT /api/persona/[personaId],パラメータ,{ name ・ description ・ personality ・ tone ・ background ・ notes ・ isDefault },レスポンス: { success } ・ ペルソナ更新API
DELETE /api/persona/[personaId],パラメータ,パスなし,レスポンス: { success ・ message } ・ ペルソナ削除API
━━━ 10. エラー・通知文言 ━━━,,,
作成エラー,表示タイミング: 名前未入力時,ペルソナ名は必須です。,
削除確認,表示タイミング: 削除ボタン押下時,このペルソナを削除してもよろしいですか？,
デフォルトペルソナ削除警告,表示タイミング: デフォルトペルソナ削除時,このペルソナはデフォルトに設定されています。削除してもよろしいですか？,
成功メッセージ,表示タイミング: 作成成功時,ペルソナを作成しました。,
成功メッセージ,表示タイミング: 更新成功時,ペルソナを更新しました。,
成功メッセージ,表示タイミング: 削除成功時,ペルソナを削除しました。,
成功メッセージ,表示タイミング: デフォルト設定成功時,デフォルトペルソナを設定しました。,
━━━ 11. モーダル仕様 ━━━,,,
ペルソナ削除確認,トリガー: 削除ボタン押下時,内容: 削除確認メッセージ ・ デフォルトペルソナの場合は警告表示,ボタン: キャンセル ・ 削除
━━━ 12. 認証・ガード ━━━,,,
認証チェック,制御方式,ペルソナ機能はログイン必須 ・ 未ログインなら/loginへリダイレクト,
権限チェック,制御方式,ペルソナは作成者のみ閲覧・編集・削除可能 ・ 他ユーザーのペルソナにアクセスすると404表示,
━━━ 13. 非機能要件 ━━━,,,
パフォーマンス,最適化手法,ペルソナ一覧はページネーション不要（通常10個程度）,
セキュリティ,セキュリティ対策,ペルソナ情報は他ユーザーに非公開 ・ APIアクセス制限,
スケーラビリティ,拡張性,ペルソナ数は無制限だが実用的には10個程度を推奨,
可用性,エラー処理,API失敗時はリトライ機能 ・ エラー時は適切なエラーメッセージ表示,
━━━ 14. テスト観点 ━━━,,,
ペルソナ作成: 正常系,テストケース,全ての項目入力でペルソナ作成成功,
ペルソナ作成: 異常系,テストケース,名前未入力でバリデーションエラー表示,
ペルソナ編集: 正常系,テストケース,既存ペルソナの情報を編集成功,
ペルソナ削除: 正常系,テストケース,削除確認後にペルソナ削除成功,
デフォルトペルソナ設定: 確認,テストケース,デフォルトペルソナ設定後にバッジ表示確認,
チャット適用: 自動選択,テストケース,チャット開始時にデフォルトペルソナが自動選択されることを確認,
チャット適用: AI反映,テストケース,選択したペルソナの設定がAI応答に反映されることを確認,
━━━ 15. 今後の拡張余地 ━━━,,,
ペルソナテンプレート,提案内容,よく使われるペルソナのテンプレートを提供,
ペルソナ共有,提案内容,ペルソナを他ユーザーと共有する機能,
ペルソナインポート,提案内容,他プラットフォームのペルソナをインポート,
ペルソナ画像,提案内容,ペルソナに画像を設定する機能,
複数ペルソナ適用,提案内容,チャット内で複数のペルソナを切り替える機能,

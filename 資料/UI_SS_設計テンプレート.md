## UI設計書・SS設計書 共通テンプレート（ナモアイ）

このテンプレートは、**画面単位**で UI 設計（画面概要）と SS 設計（項目定義）を記述し、  
`scripts/generate-ui-ss-excel.mjs` により **Excel UI/SS 設計書** に自動変換されることを前提としています。

> 💡 必須ルール（スクリプト連携のため）
> - 各画面は `###` 見出しから始めます（例: `### LOGIN001 ログイン画面`）
> - 「画面基本情報」「画面項目定義」という **見出しテキスト** をそのまま使用してください
> - 各セクション直下の **最初の Markdown 表** が Excel に取り込まれます
> - 表ヘッダー行は **列名を変更せず** に使用してください（列の順番は維持）

---

### LOGIN001 ログイン画面

#### 画面基本情報

| ScreenID | 画面名       | URL      | 画面種別 | 機能カテゴリ         | 対象ロール             | 概要                                       | 備考                     |
| :------- | :----------- | :------- | :------- | :------------------- | :--------------------- | :----------------------------------------- | :----------------------- |
| LOGIN001 | ログイン画面 | /login   | 入力画面 | 01_認証・ユーザー管理 | 未ログインユーザー、一般ユーザー | メールアドレス／パスワードまたは Google ログインを提供する画面 | パスワード再設定は将来対応 |

#### 画面項目定義

| No | フィールドID    | 項目名（表示ラベル） | 項目名（論理名）     | UI種別       | 必須 | 型       | 桁数 | 初期値 | 入力制御                          | バリデーション例                                                     | エラー文言例                                           | 関連API                   | 備考                             |
| :- | :-------------- | :------------------- | :------------------- | :----------- | :--- | :------- | :--- | :----- | :-------------------------------- | :------------------------------------------------------------------- | :----------------------------------------------------- | :------------------------ | :------------------------------- |
| 1  | login_email     | メールアドレス       | email                | テキストボックス | 必須 | string  | 256 |       | 半角英数字、記号 @.-\_ のみ許可 | メール形式チェック（`/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/`）                | メールアドレスの形式が正しくありません。             | POST /api/register        | Google ログイン時は非表示        |
| 2  | login_password  | パスワード           | password             | パスワード   | 必須 | string  | 72  |       | 8〜16文字                         | 文字数チェック（8〜16文字）、必要に応じて英数混在                     | パスワードは8〜16文字で入力してください。             | POST /api/auth/[...nextauth] |                                |
| 3  | login_submit    | ログイン             | loginButton          | ボタン       | -   | -       | -   |       | 入力必須項目が全て入力された場合のみ活性 | クリック時にフォームバリデーション → API 呼び出し                      | メールアドレスまたはパスワードが正しくありません。 | POST /api/auth/[...nextauth] | ローディング状態をボタン上で表示 |

---

### HOME001 ホーム（メインページ）

#### 画面基本情報

| ScreenID | 画面名             | URL   | 画面種別 | 機能カテゴリ           | 対象ロール | 概要                                                     | 備考                            |
| :------- | :----------------- | :---- | :------- | :--------------------- | :--------- | :------------------------------------------------------- | :------------------------------ |
| HOME001  | ホーム（メイン）   | /     | 一覧画面 | 07_検索・ランキング     | 全ユーザー | トレンドキャラクター、新着、特集などを一覧表示するトップページ | 未ログインでも閲覧可能          |

#### 画面項目定義

| No | フィールドID        | 項目名（表示ラベル）       | 項目名（論理名）         | UI種別       | 必須 | 型      | 桁数 | 初期値 | 入力制御        | バリデーション例 | エラー文言例                 | 関連API          | 備考                                       |
| :- | :------------------ | :------------------------- | :----------------------- | :----------- | :--- | :------ | :--- | :----- | :-------------- | :-------------- | :------------------------- | :--------------- | :----------------------------------------- |
| 1  | home_trending_list  | 今話題のキャラクター一覧   | trendingCharacters       | カードリスト | -   | object | -   |       | API結果をそのまま表示 | -              | データ取得に失敗しました。 | GET /api/main-page | 配列が空の場合はセクション自体を非表示    |
| 2  | home_new_top10_list | ホットな新作TOP10         | newTopCharacters         | カードリスト | -   | object | -   |       | 同上             | -              | データ取得に失敗しました。 | GET /api/main-page | 10件を上限としてソート済みで返却される前提 |

---

### CHARLIST001 キャラクター一覧

#### 画面基本情報

| ScreenID    | 画面名             | URL       | 画面種別 | 機能カテゴリ       | 対象ロール | 概要                                                         | 備考                             |
| :---------- | :----------------- | :-------- | :------- | :----------------- | :--------- | :----------------------------------------------------------- | :------------------------------- |
| CHARLIST001 | キャラクター一覧   | /charlist | 一覧画面 | 02_キャラクター管理 | 全ユーザー | タグや並び替えを用いて公開キャラクターを一覧・検索する画面 | ガード無し（未ログインでも閲覧可） |

#### 画面項目定義

| No | フィールドID          | 項目名（表示ラベル） | 項目名（論理名）   | UI種別         | 必須 | 型      | 桁数 | 初期値 | 入力制御                     | バリデーション例 | エラー文言例                   | 関連API          | 備考                                      |
| :- | :-------------------- | :------------------- | :----------------- | :------------- | :--- | :------ | :--- | :----- | :--------------------------- | :-------------- | :--------------------------- | :--------------- | :---------------------------------------- |
| 1  | charlist_tag_chips    | タグチップ           | activeTag          | チップリスト   | -   | string  | 50  |       | クリックでタグを選択/解除    | -              | -                           | GET /api/charlist | 横スクロール、選択中はピンク背景           |
| 2  | charlist_sort_menu    | 並び替え             | activeSort         | ドロップダウン | -   | string  | 20  | newest | newest/popular/likes から選択 | -              | -                           | GET /api/charlist | 開閉時にアイコン回転                       |
| 3  | charlist_result_grid  | キャラクター一覧     | characters         | カードグリッド | -   | object | -   |       | API結果をそのままカード表示 | -              | データ取得に失敗しました。 | GET /api/charlist | 画像／名前／説明／チャット数／いいね数表示 |

---

### SEARCH001 検索

#### 画面基本情報

| ScreenID | 画面名 | URL      | 画面種別 | 機能カテゴリ       | 対象ロール | 概要                                                         | 備考                             |
| :------- | :----- | :------- | :------- | :----------------- | :--------- | :----------------------------------------------------------- | :------------------------------- |
| SEARCH001 | 検索  | /search  | 検索画面 | 07_検索・ランキング | 全ユーザー | キーワード検索および最近/人気検索語からキャラクターを探す画面 | ガード無し（未ログインでも閲覧可） |

#### 画面項目定義

| No | フィールドID           | 項目名（表示ラベル） | 項目名（論理名） | UI種別         | 必須 | 型      | 桁数 | 初期値 | 入力制御                                    | バリデーション例 | エラー文言例                       | 関連API          | 備考                                                |
| :- | :--------------------- | :------------------- | :--------------- | :------------- | :--- | :------ | :--- | :----- | :------------------------------------------ | :-------------- | :------------------------------- | :--------------- | :-------------------------------------------------- |
| 1  | search_query_input     | 検索キーワード       | query            | テキストボックス | -   | string  | 100 |       | Enterで検索実行、入力中はローカル状態のみ保持 | -              | 検索に失敗しました。           | GET /api/search   | placeholder「話したいキャラクターを探す」             |
| 2  | search_recent_chips    | 最近の検索語         | recentSearches   | チップリスト   | -   | string  | 100 |       | localStorage から最大5件を表示               | -              | -                               | -               | ×クリックで個別削除、「すべて削除」ボタンあり           |
| 3  | search_popular_list    | 人気の検索語         | popularKeywords  | ランキングリスト | -   | string  | 100 |       | 取得済みキーワードを順位付きで表示           | -              | データ取得に失敗しました。       | GET /api/search   | クリックで即時検索実行                               |
| 4  | search_result_list     | 検索結果             | searchResults    | カードリスト   | -   | object | -   |       | API結果をカードとして一覧表示                | -              | 検索結果が見つかりませんでした。 | GET /api/search   | 画像／名前／説明／ハッシュタグピルを表示                |

---

### RANK001 ランキング

#### 画面基本情報

| ScreenID | 画面名   | URL       | 画面種別 | 機能カテゴリ       | 対象ロール | 概要                                           | 備考                             |
| :------- | :------- | :-------- | :------- | :----------------- | :--------- | :--------------------------------------------- | :------------------------------- |
| RANK001  | ランキング | /ranking | 一覧画面 | 07_検索・ランキング | 全ユーザー | 期間別（リアルタイム/日/週/月）の人気キャラクターランキングを表示 | ガード無し（未ログインでも閲覧可） |

#### 画面項目定義

| No | フィールドID        | 項目名（表示ラベル） | 項目名（論理名） | UI種別       | 必須 | 型      | 桁数 | 初期値   | 入力制御                                           | バリデーション例 | エラー文言例             | 関連API          | 備考                                                |
| :- | :------------------ | :------------------- | :--------------- | :----------- | :--- | :------ | :--- | :------- | :------------------------------------------------- | :-------------- | :--------------------- | :--------------- | :-------------------------------------------------- |
| 1  | rank_period_tabs    | 期間タブ             | activeTab        | タブ         | 必須 | string  | 10  | realtime | realtime/daily/weekly/monthly のいずれか          | -              | -                     | GET /api/ranking | クリックで再取得、アクティブはピンク背景               |
| 2  | rank_list           | ランキングリスト     | ranking          | リスト       | -   | object | -   |         | API結果を順位付きで表示                            | -              | データ取得に失敗しました。 | GET /api/ranking | 1〜3位は王冠アイコン、以降は番号表示、チャット数など表示 |

---

### POINTS001 ポイント

#### 画面基本情報

| ScreenID  | 画面名 | URL      | 画面種別 | 機能カテゴリ       | 対象ロール   | 概要                                             | 備考                                   |
| :-------- | :----- | :------- | :------- | :----------------- | :----------- | :----------------------------------------------- | :------------------------------------- |
| POINTS001 | ポイント | /points | 情報画面 | 06_ポイントシステム | 認証済みユーザー | 保有ポイントと毎日出席ボーナス、ポイント購入メニューを表示 | API側でログイン判定（画面自体はガード無し） |

#### 画面項目定義

| No | フィールドID         | 項目名（表示ラベル）   | 項目名（論理名）   | UI種別       | 必須 | 型      | 桁数 | 初期値 | 入力制御                                           | バリデーション例 | エラー文言例                                       | 関連API          | 備考                                           |
| :- | :------------------- | :--------------------- | :----------------- | :----------- | :--- | :------ | :--- | :----- | :------------------------------------------------- | :-------------- | :------------------------------------------------- | :--------------- | :----------------------------------------------- |
| 1  | points_total_card    | 保有ポイント           | points.total       | 情報カード   | -   | number | -   | 0     | API結果をそのまま表示、toLocaleString で桁区切り | -              | データ取得に失敗しました。                       | GET /api/points  | 無料/有料/合計ポイントをまとめて表示              |
| 2  | points_attend_button | 出席ボタン             | attendedToday      | ボタン       | 必須 | boolean | -   | false | attendedToday が false のときのみ有効             | -              | 今日は既に出席チェックを行いました。           | POST /api/points | body: { type: 'check-in' }、成功時にポイント再取得 |
| 3  | points_purchase_list | ポイント購入プリセット | purchasePresets    | ボタンリスト | -   | object | -   |       | クリックで課金API呼び出し                          | -              | ポイント購入に失敗しました。                     | POST /api/points | body: { type: 'charge', amount: \<points\> }       |

---

### MYPAGE001 マイページ

#### 画面基本情報

| ScreenID  | 画面名   | URL      | 画面種別 | 機能カテゴリ             | 対象ロール   | 概要                                   | 備考                                        |
| :-------- | :------- | :------- | :------- | :----------------------- | :----------- | :--------------------------------------- | :------------------------------------------ |
| MYPAGE001 | マイページ | /MyPage | メニュー | 01_認証・ユーザー管理ほか | 全ユーザー   | 認証状態に応じてプロフィール/ポイント/各種メニューを表示 | 未ログイン時はログイン導線のみ、認証時はフルメニュー |

#### 画面項目定義

| No | フィールドID            | 項目名（表示ラベル） | 項目名（論理名） | UI種別       | 必須 | 型      | 桁数 | 初期値 | 入力制御                                               | バリデーション例 | エラー文言例           | 関連API            | 備考                                              |
| :- | :---------------------- | :------------------- | :--------------- | :----------- | :--- | :------ | :--- | :----- | :----------------------------------------------------- | :-------------- | :--------------------- | :----------------- | :------------------------------------------------ |
| 1  | mypage_profile_card     | プロフィール         | profileSummary   | 情報カード   | -   | object | -   |       | セッション情報と /api/users/profile を組み合わせて表示 | -              | プロフィール取得に失敗しました。 | GET /api/users/profile | 名前/ニックネーム/ロールバッジなど                  |
| 2  | mypage_points_entry     | ポイント             | pointsEntry      | メニュー行   | -   | -      | -   |       | クリックで /points へ遷移                              | -              | -                     | -                 | 保有ポイントの概要も右側に小さく表示               |
| 3  | mypage_character_entry  | キャラクター管理     | characterEntry   | メニュー行   | -   | -      | -   |       | クリックで /character-management へ遷移                | -              | -                     | -                 | 自作キャラクター一覧への導線                       |
| 4  | mypage_safety_toggle    | セーフティフィルター | safetyFilter     | トグル       | 必須 | boolean | -   | true  | クリックで PUT /api/users/safety-filter を呼び出し     | -              | 更新に失敗しました。   | PUT /api/users/safety-filter | OFFへ切り替える際は年齢確認モーダルを表示            |

---

### CHAT001 チャット（メイン）

#### 画面基本情報

| ScreenID | 画面名             | URL                 | 画面種別 | 機能カテゴリ   | 対象ロール   | 概要                                             | 備考                        |
| :------- | :----------------- | :------------------ | :------- | :------------- | :----------- | :----------------------------------------------- | :-------------------------- |
| CHAT001  | チャット（メイン） | /chat/\[characterId\] | 入力画面 | 03_チャットシステム | 認証済みユーザー | キャラクターとのメッセージ送受信および画像表示を行う画面 | 停止ユーザーはアクセス不可 |

#### 画面項目定義

| No | フィールドID                 | 項目名（表示ラベル）     | 項目名（論理名）         | UI種別             | 必須 | 型      | 桁数 | 初期値 | 入력制御                                                     | バリデーション例 | エラー文言例                             | 関連API                          | 備考                                             |
| :- | :--------------------------- | :----------------------- | :----------------------- | :----------------- | :--- | :------ | :--- | :----- | :----------------------------------------------------------- | :-------------- | :------------------------------------- | :------------------------------- | :----------------------------------------------- |
| 1  | chat_message_input           | メッセージ入力           | messageContent           | テキストエリア     | 必須 | string  | 2000 |       | Enterで送信／Shift+Enterで改行                               | 1〜2000文字     | メッセージを送信できませんでした。     | POST /api/chat/messages          | 送信時にポイント消費、空文字は送信不可             |
| 2  | chat_image_input             | 画像添付                 | messageImage             | ファイル入力       | -   | file    | -   |       | 1メッセージ1枚、5MB以下、対応拡張子のみ                      | サイズ/拡張子チェック | 画像サイズは5MB以下にしてください。   | POST /api/chat/messages          | 画像付きメッセージはAIが画像も考慮して応答生成       |
| 3  | chat_message_list            | メッセージ一覧           | messages                 | メッセージリスト   | -   | object | -   |       | 最新100件を読み込み、ロール（user/modelなど）ごとにスタイル分岐 | -              | データ取得に失敗しました。             | GET /api/chat/messages           | 初期状況メッセージを先頭に表示                        |
| 4  | chat_settings_button         | 設定ボタン               | showSettings             | ボタン             | -   | boolean | -   | false | クリックで ChatSettings パネルを開閉                         | -              | -                                   | -                               | ペルソナ選択・セーフティフィルター・保存機能などへ   |
| 5  | chat_settings_panel          | チャット設定パネル       | chatSettings             | スライドインパネル | -   | object | -   |       | showSettings が true のとき右側からスライドイン              | -              | -                                   | -                               | ChatSettings.tsx、トグル/保存/ノート/新規チャットを含む |
| 6  | chat_setting_show_image      | チャットイメージ表示     | showChatImage            | トグル             | 必須 | boolean | -   | true  | パネル内のトグルでオン/オフ切り替え                          | -              | 更新に失敗しました。                 | PATCH /api/chat/[chatId]        | ChatMessageParser で {img:n} の表示有無を制御          |
| 7  | chat_setting_multi_image     | マルチイメージ表示       | isMultiImage             | トグル             | 必須 | boolean | -   | false | パネル内のトグルでオン/オフ切り替え                          | -              | 更新に失敗しました。                 | PATCH /api/chat/[chatId]        | 複数画像を同時に表示するかどうかを制御                |
| 8  | chat_note_modal              | ユーザーノートモーダル   | userNote                 | モーダル           | -   | string  | 5000 |       | 設定パネルから起動、保存時に PATCH /api/chat/[chatId]/note 呼び出し | 最大5000文字   | ノートの保存に失敗しました。         | PATCH /api/chat/[chatId]/note   | プロットや重要情報をメモとして保存、チャットに影響     |
| 9  | chat_save_conversation_modal | 会話保存モーダル         | saveConversationOptions  | モーダル           | -   | object | -   |       | 設定パネルから起動、TXT/PNG などの形式を選択して保存         | -              | 保存処理に失敗しました。             | -                               | onSaveConversationAsText/Image などのハンドラを呼び出し |
| 10 | chat_new_chat_button         | 新しいチャットボタン     | newChat                  | ボタン             | -   | boolean | -   | false | 設定パネル内の赤いボタン、クリックで新規チャットを開始       | -              | 新規チャットの作成に失敗しました。   | POST /api/chats/find-or-create | forceNew:true で新規セッションを作成                   |

---

### CHATLIST001 チャット一覧

#### 画面基本情報

| ScreenID    | 画面名       | URL        | 画面種別 | 機能カテゴリ   | 対象ロール   | 概要                                         | 備考                    |
| :---------- | :----------- | :--------- | :------- | :------------- | :----------- | :------------------------------------------- | :---------------------- |
| CHATLIST001 | チャット一覧 | /chatlist  | 一覧画面 | 03_チャットシステム | 認証済みユーザー | これまでのチャットセッションを一覧し再開・新規作成する画面 | 認証済みユーザー専用   |

#### 画面項目定義

| No | フィールドID        | 項目名（表示ラベル） | 項目名（論理名） | UI種別       | 必須 | 型      | 桁数 | 初期値 | 入力制御                               | バリデーション例 | エラー文言例                       | 関連API        | 備考                                      |
| :- | :------------------ | :------------------- | :--------------- | :----------- | :--- | :------ | :--- | :----- | :------------------------------------- | :-------------- | :------------------------------- | :------------- | :---------------------------------------- |
| 1  | chatlist_search_box | チャット検索         | searchKeyword    | テキストボックス | -   | string  | 100 |       | 現状はローカルフィルタのみ（将来拡張） | -              | -                               | -             | プレースホルダのみ、検索ロジックは未実装 |
| 2  | chatlist_list       | チャット一覧         | chats            | リスト       | -   | object | -   |       | API結果をカードとして一覧表示          | -              | データ取得に失敗しました。       | GET /api/chats | 最終メッセージと更新日を表示               |

---

### NOTICE001 お知らせ一覧

#### 画面基本情報

| ScreenID  | 画面名       | URL      | 画面種別 | 機能カテゴリ       | 対象ロール | 概要                               | 備考                                   |
| :-------- | :----------- | :------- | :------- | :----------------- | :--------- | :--------------------------------- | :------------------------------------- |
| NOTICE001 | お知らせ一覧 | /notice  | 一覧画面 | 09_お知らせ及びガイド | 全ユーザー | お知らせ（更新情報など）の一覧を表示 | 未ログインでも閲覧可能、ADMINは作成ボタン表示 |

#### 画面項目定義

| No | フィールドID        | 項目名（表示ラベル） | 項目名（論理名） | UI種別   | 必須 | 型      | 桁数 | 初期値 | 入力制御                              | バリデーション例 | エラー文言例                 | 関連API         | 備考                                         |
| :- | :------------------ | :------------------- | :--------------- | :------- | :--- | :------ | :--- | :----- | :------------------------------------ | :-------------- | :------------------------- | :-------------- | :------------------------------------------- |
| 1  | notice_list         | お知らせ一覧         | notices          | リスト   | -   | object | -   |       | API結果をカードとして一覧表示         | -              | データ取得に失敗しました。 | GET /api/notice | カテゴリ/タイトル/作成日を表示                 |
| 2  | notice_new_button   | 新規作成ボタン       | canCreate        | ボタン   | -   | boolean | -   | false | ADMIN権限時のみ表示、クリックで管理画面へ | -              | この操作を実行する権限がありません。 | -              | session.user.role === 'ADMIN' の場合のみ表示 |

---

### PERSONA001 ペルソナ一覧

#### 画面基本情報

| ScreenID   | 画面名       | URL            | 画面種別 | 機能カテゴリ     | 対象ロール   | 概要                                           | 備考                    |
| :--------- | :----------- | :------------- | :------- | :--------------- | :----------- | :--------------------------------------------- | :---------------------- |
| PERSONA001 | ペルソナ一覧 | /persona/list  | 一覧画面 | 05_ペルソナシステム | 認証済みユーザー | 自分のペルソナ一覧を表示し、デフォルト選択・編集・削除を行う画面 | 認証必須               |

#### 画面項目定義

| No | フィールドID           | 項目名（表示ラベル） | 項目名（論理名） | UI種別       | 必須 | 型      | 桁数 | 初期値 | 入力制御                              | バリデーション例 | エラー文言例                       | 関連API        | 備考                                               |
| :- | :--------------------- | :------------------- | :--------------- | :----------- | :--- | :------ | :--- | :----- | :------------------------------------ | :-------------- | :----------------------------- | :------------- | :------------------------------------------------- |
| 1  | persona_list           | ペルソナ一覧         | personas         | カードリスト | -   | object | -   |       | API結果をカードとして一覧表示         | -              | データ取得に失敗しました。     | GET /api/persona | デフォルトペルソナにはバッジを表示                    |
| 2  | persona_default_select | ペルソナ選択         | defaultPersonaId | 選択操作     | 必須 | number | -   |       | 行クリックでPATCH /api/persona を呼び出し | -              | 更新に失敗しました。           | PATCH /api/persona | 選択失敗時は元の選択状態にロールバックする            |
| 3  | persona_add_button     | ペルソナ追加         | -               | ボタン       | -   | -      | -   |       | クリックで /persona/form へ遷移        | -              | -                             | -             | プラスアイコン付きの追加行                           |

---

### PERSONA002 ペルソナ作成・修正

#### 画面基本情報

| ScreenID   | 画面名             | URL                               | 画面種別 | 機能カテゴリ     | 対象ロール   | 概要                                     | 備考                    |
| :--------- | :----------------- | :-------------------------------- | :------- | :--------------- | :----------- | :--------------------------------------- | :---------------------- |
| PERSONA002 | ペルソナ作成・修正 | /persona/form/\[\[...personaId\]\] | 入力画面 | 05_ペルソナシステム | 認証済みユーザー | ペルソナの名前/性格/口調/背景などを編集する画面 | 新規/編集モードをURLで判定 |

#### 画面項目定義

| No | フィールドID        | 項目名（表示ラベル） | 項目名（論理名） | UI種別       | 必須 | 型      | 桁数 | 初期値 | 入力制御                                  | バリデーション例         | エラー文言例                           | 関連API            | 備考                                            |
| :- | :------------------ | :------------------- | :--------------- | :----------- | :--- | :------ | :--- | :----- | :---------------------------------------- | :---------------------- | :----------------------------------- | :----------------- | :---------------------------------------------- |
| 1  | persona_name        | ペルソナ名           | name             | テキストボックス | 必須 | string  | 100 |       | 入力に応じて文字数カウンタを更新         | 1〜100文字              | ペルソナ名は必須です。               | POST/PUT /api/persona | isEditModeに応じてPOST/PUTを切り替え              |
| 2  | persona_description | 説明                 | description      | テキストエリア | -   | string  | 500 |       |                                          | 最大500文字             | 説明は500文字以内で入力してください。 | POST/PUT /api/persona |                                             |
| 3  | persona_personality | 性格                 | personality      | テキストエリア | -   | string  | 1000|       |                                          | 最大1000文字            | 性格は1000文字以内で入力してください。 | POST/PUT /api/persona |                                             |
| 4  | persona_tone        | 口調                 | tone             | テキストエリア | -   | string  | 500 |       |                                          | 最大500文字             | 口調は500文字以内で入力してください。 | POST/PUT /api/persona |                                             |
| 5  | persona_is_default  | デフォルトに設定     | isDefault        | チェックボックス | -   | boolean | -   | false | チェック時、このペルソナをデフォルトに設定 | -                      | 更新に失敗しました。                 | POST/PUT /api/persona | 保存後は一覧画面に戻り、router.refresh を実行      |

---

### PROFILE001 マイプロフィール

#### 画面基本情報

| ScreenID  | 画面名         | URL              | 画面種別 | 機能カテゴリ             | 対象ロール   | 概要                                           | 備考                    |
| :-------- | :------------- | :--------------- | :------- | :----------------------- | :----------- | :--------------------------------------------- | :---------------------- |
| PROFILE001 | マイプロフィール | /profile/\[userId\] | 情報画面 | 01_認証・ユーザー管理ほか | 全ユーザー   | プロフィール詳細およびフォロー情報、作成キャラクターを表示する画面 | 本人/他人で表示内容が変化 |

#### 画面項目定義

| No | フィールドID              | 項目名（表示ラベル）   | 項目名（論理名） | UI種別       | 必須 | 型      | 桁数 | 初期値 | 入력制御                                       | バリデーション例 | エラー文言例                       | 関連API                      | 備考                                                |
| :- | :------------------------ | :--------------------- | :--------------- | :----------- | :--- | :------ | :--- | :----- | :--------------------------------------------- | :-------------- | :------------------------------- | :--------------------------- | :-------------------------------------------------- |
| 1  | profile_header            | プロフィールヘッダー   | profile          | 情報カード   | -   | object | -   |       | API結果をもとに画像/ニックネーム/フォロー数表示 | -              | プロファイルが見つかりません。   | GET /api/profile/[userId]    | isMyProfileかどうかでメニュー表示を切り替え         |
| 2  | profile_follow_counts     | フォロー/フォロワー数 | followStats      | 情報ラベル   | -   | object | -   |       | フォロー数/フォロワー数をタップ可能なラベルで表示 | -              | データ取得に失敗しました。       | GET /api/profile/[userId]    | クリックで一覧モーダル（フォロワー/フォロー）を表示 |
| 3  | profile_follow_button     | フォロー/アンフォロー | isFollowing      | トグルボタン | -   | boolean | -   | false | 本人以外のプロフィールでのみ表示、クリックでトグル | -              | フォロー操作に失敗しました。     | POST /api/profile/[userId]/follow | 成功時はラベルとカウントを即時更新                  |
| 4  | profile_edit_button       | プロフィール編集       | canEdit          | ボタン       | -   | boolean | -   | false | 本人の場合のみ /profile-edit へ遷移           | -              | -                               | -                           | session.user.id === profile.id の場合のみ表示       |

---

### PROFILEEDIT001 プロフィール編集

#### 画面基本情報

| ScreenID       | 画面名           | URL            | 画面種別 | 機能カテゴリ             | 対象ロール   | 概要                                     | 備考        |
| :------------- | :--------------- | :------------- | :------- | :----------------------- | :----------- | :--------------------------------------- | :---------- |
| PROFILEEDIT001 | プロフィール編集 | /profile-edit  | 入力画面 | 01_認証・ユーザー管理ほか | 認証済みユーザー | 自分のニックネーム/自己紹介/アイコン画像を編集する画面 | 認証必須     |

#### 画面項目定義

| No | フィールドID           | 項目名（表示ラベル） | 項目名（論理名） | UI種別       | 必須 | 型      | 桁数 | 初期値 | 入力制御                                     | バリデーション例         | 에러文言例                           | 関連API              | 備考                                             |
| :- | :--------------------- | :------------------- | :--------------- | :----------- | :--- | :------ | :--- | :----- | :------------------------------------------- | :---------------------- | :----------------------------------- | :------------------- | :----------------------------------------------- |
| 1  | profileedit_nickname   | ニックネーム         | nickname         | テキストボックス | 必須 | string  | 50  |       | 取得済みプロフィールから初期値を設定         | 1〜50文字              | ニックネームは1〜50文字で入力してください。 | PUT /api/users/profile | 保存後、セッション情報も update で同期             |
| 2  | profileedit_bio        | 自己紹介             | bio              | テキストエリア | -   | string  | 500 |       |                                           | 最大500文字             | 自己紹介は500文字以内で入力してください。 | PUT /api/users/profile |                                                |
| 3  | profileedit_image_file | プロフィール画像     | image            | ファイル入力   | -   | file    | -   |       | 画像選択時に即時プレビューを表示             | サイズ/拡張子チェック    | 画像サイズは5MB以下にしてください。 | PUT /api/users/profile | next/image でプレビュー、アップロードはFormDataで送信 |

---

### REGISTER001 会員登録

#### 画面基本情報

| ScreenID   | 画面名   | URL       | 画面種別 | 機能カテゴリ       | 対象ロール   | 概要                               | 備考        |
| :--------- | :------- | :-------- | :------- | :----------------- | :----------- | :--------------------------------- | :---------- |
| REGISTER001 | 会員登録 | /register | 入力画面 | 01_認証・ユーザー管理 | 未ログインユーザー | メール/パスワードなどで新規会員登録を行う画面 | 로그인画面から遷移 |

#### 画面項目定義

| No | フィールドID       | 項目名（表示ラベル） | 項目名（論理名） | UI種別       | 必須 | 型      | 桁数 | 初期値 | 입력制御                                      | バリデーション例                             | エラー文言例                                 | 関連API          | 備考                                      |
| :- | :----------------- | :------------------- | :--------------- | :----------- | :--- | :------ | :--- | :----- | :-------------------------------------------- | :------------------------------------------ | :----------------------------------------- | :--------------- | :---------------------------------------- |
| 1  | register_email     | メールアドレス       | email            | テキストボックス | 必須 | string  | 256 |       | 클라이언트側で 이메일形式/중복 체크             | `/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/`          | このメールアドレスは既に登録されています。 | POST /api/register |                                      |
| 2  | register_password  | パスワード           | password         | パスワード     | 必須 | string  | 16  |       | 8〜16文字、英数字混在を推奨                    | /^.{8,16}$/                                | パスワードは8〜16文字で入力してください。 | POST /api/register |                                      |
| 3  | register_name      | 氏名                 | name             | テキストボックス | 必須 | string  | 50  |       |                                           | 全角ひらがな/カタカナ/漢字のみ許可             | 氏名の形式が正しくありません。             | POST /api/register |                                      |
| 4  | register_phone     | 電話番号             | phone            | テキストボックス | 必須 | string  | 13  |       |                                           | /^070-\\d{4}-\\d{4}$/                      | 電話番号の形式が正しくありません。         | POST /api/register |                                      |
| 5  | register_nickname  | ニックネーム         | nickname         | テキストボックス | 必須 | string  | 12  |       |                                           | /^.{2,12}$/                               | ニックネームは2〜12文字で入力してください。 | POST /api/register |                                      |

---

### GUIDE001 ユーザーガイド

#### 画面基本情報

| ScreenID | 画面名       | URL      | 画面種別 | 機能カテゴリ       | 対象ロール | 概要                                                     | 備考                             |
| :------- | :----------- | :------- | :------- | :----------------- | :--------- | :------------------------------------------------------- | :------------------------------- |
| GUIDE001 | ユーザーガイド | /guide  | 情報画面 | 09_お知らせ及びガイド | 全ユーザー | 大分類/小分類ごとにユーザーガイド記事を階層表示する画面 | 未ログインでも閲覧可能、一部メニューは管理者のみ表示 |

#### 画面項目定義

| No | フィールドID          | 項目名（表示ラベル） | 項目名（論理名） | UI種別           | 必須 | 型      | 桁数 | 初期値 | 入力制御                                  | バリデーション例 | エラー文言例                       | 関連API        | 備考                                            |
| :- | :-------------------- | :------------------- | :--------------- | :--------------- | :--- | :------ | :--- | :----- | :---------------------------------------- | :-------------- | :----------------------------- | :------------- | :---------------------------------------------- |
| 1  | guide_sidebar_tree    | ガイドカテゴリツリー | guideTree        | アコーディオン   | -   | object | -   |       | メイン/サブカテゴリーをツリー状に展開     | -              | データ取得に失敗しました。     | GET /api/guides | クリックで記事選択、選択中は強調表示               |
| 2  | guide_content         | ガイド本文           | selectedGuide    | HTML表示         | -   | string  | -   |       | dangerouslySetInnerHTML でHTMLを描画     | -              | -                             | GET /api/guides | prose/prose-invert クラスで可読性を確保            |
| 3  | guide_admin_button    | ガイド管理           | canManageGuides  | ボタン           | -   | boolean | -   | false | 管理者権限（MODERATOR以上）の場合のみ表示 | -              | この操作を実行する権限がありません。 | -             | /admin/guides への導線、session.user.role で制御 |

---

## 新規画面を追加する手順

1. 上記のサンプルをコピーして、`###` 見出しの ScreenID・画面名・URL を書き換えます  
2. 「画面基本情報」表に、画面の概要とロール、カテゴリを記入します  
3. 「画面項目定義」表に、入力項目・表示項目・ボタンなどを 1 行ずつ追加します  
4. ファイル全体を保存し、以下のコマンドで Excel UI/SS 設計書を生成します：

```bash
npm run generate:ui-ss
```

生成結果は、プロジェクトルート直下に `UI_SS設計書_ナモアイ_YYYY-MM-DD.xlsx` という形式で保存されます。



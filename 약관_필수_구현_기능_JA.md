## 🚨 最優先必須実装（法的必須）

> **参考**: このセクションには、本当に必須で実装すべき機能のみが含まれます。選択項目は下部の「選択項目」セクションを参照してください。

### 1. 規約ページ（⭐⭐⭐⭐⭐）

#### 1.1 利用規約ページ（`/terms`）
- **規約要件**: 第5条（規約変更通知）、第44条（通知方法）
- **現在の状態**: ❌ 未実装
- **必須内容**:
  - 規約全体の内容表示
  - バージョン管理（最終更新日）
  - 規約同意履歴の記録（会員登録時）
- **実装ファイル**:
  - `src/app/terms/page.tsx`（新規作成）
  - `src/app/api/terms/agree/route.ts`（規約同意API）
  - `terms_agreements`テーブル（規約同意履歴）

#### 1.2 プライバシーポリシーページ（`/privacy`）
- **規約要件**: 第39条（個人情報の取扱い）
- **現在の状態**: ❌ 未実装
- **必須内容**:
  - プライバシーポリシー全体の内容表示
  - バージョン管理（最終更新日）
  - 規約同意履歴の記録（会員登録時）
- **実装ファイル**:
  - `src/app/privacy/page.tsx`（新規作成）
  - 既存の`ナモアイ_プライバシーポリシー.md`の内容を活用

#### 1.3 特定商取引法ページ（`/tokushoho`）
- **規約要件**: 特定商取引法の告知義務
- **現在の状態**: ❌ 未実装
- **必須内容**:
  - 事業者情報（会社名、代表者、住所、電話番号、メールアドレス）
  - 販売価格
  - 支払方法
  - 商品引渡時期
  - 返品・交換ポリシー
- **実装ファイル**:
  - `src/app/tokushoho/page.tsx`（新規作成）

---

### 2. Cookie同意バナー（⭐⭐⭐⭐⭐）

#### 2.1 Cookie同意バナーコンポーネント
- **規約要件**: プライバシーポリシー第6条（外部送信・情報収集モジュール）
- **現在の状態**: ❌ 未実装
- **必須機能**:
  - 必須Cookie / 選択Cookieの区別
  - 同意/拒否の選択
  - LocalStorageへの同意状態の保存
  - Google Analyticsの条件付きロード（同意時のみ）
- **実装ファイル**:
  - `src/components/CookieConsent.tsx`（新規作成）
  - `src/app/layout.tsx`にバナーを追加
  - `users.cookieConsent`フィールドを追加（DB）

---

### 3. チャットログ自動削除設定（⭐⭐⭐⭐⭐）

#### 3.1 チャットログ自動削除設定
- **規約要件**: プライバシーポリシー第2条の2第1項（チャットログの取扱い）
- **現在の状態**: ❌ 未実装
- **必須機能**:
  - ユーザー設定で「自動削除を有効化」オプション
  - 最終利用日から90日後の自動削除
  - ユーザー削除機能（全体/一部削除）
  - 1年間未アクセス時の削除（自動削除設定時）
- **実装ファイル**:
  - `src/app/settings/privacy/page.tsx`に設定を追加
  - `src/app/api/users/settings/auto-delete/route.ts`（新規作成）
  - `src/app/api/users/chat-logs/delete/route.ts`（新規作成）
  - `users.autoDeleteChatLogs`フィールドを追加（DB）
  - バッチジョブ: 毎日実行して期限切れのチャットログを削除

---

### 4. ポイント有効期限管理（⭐⭐⭐⭐⭐）

#### 4.1 無償ポイント有効期限管理
- **規約要件**: 第14条（無償ポイント1年間有効期限）
- **現在の状態**: ❌ 未実装
- **必須機能**:
  - 無償ポイント付与時に1年後の有効期限を設定
  - 期限切れの無償ポイントの自動削除
  - 期限7日前の通知送信
- **実装ファイル**:
  - `points.freePointsExpiresAt`フィールドを追加（DB）
  - `src/app/api/points/expire/route.ts`（新規作成）
  - バッチジョブ: 毎日実行して期限切れのポイントを削除し、通知を送信

---

### 5. 個人情報の開示・修正・削除リクエスト（⭐⭐⭐⭐⭐）

#### 5.1 個人情報リクエストシステム
- **規約要件**: プライバシーポリシー第8条（個人情報の開示・修正・利用停止等）
- **現在の状態**: ❌ 未実装
- **必須機能**:
  - 個人情報開示リクエスト（PDFダウンロード）
  - 個人情報修正リクエスト
  - 個人情報削除リクエスト
  - 利用停止リクエスト
  - 本人確認手続き
  - 手数料処理（開示リクエスト時1,000円）
- **実装ファイル**:
  - `src/app/settings/data/page.tsx`（新規作成）
  - `src/app/api/users/privacy-request/route.ts`（新規作成）

---

### 6. 規約変更通知（⭐⭐⭐⭐）

#### 6.1 規約変更通知システム
- **規約要件**: 第5条（規約変更通知 - 効力発生10日前）
- **現在の状態**: ❌ 未実装
- **必須機能**:
  - 規約変更内容の掲載
  - 効力発生日の明示
  - 10日前の自動告知
  - メール通知（規約変更時）
  - 再同意の要求（未同意時はサービス利用を制限）
- **実装ファイル**:
  - `src/app/api/terms/notify-change/route.ts`（新規作成）
  - `terms_agreements`テーブルにバージョン管理を追加

---

## 📊 優先順位別実装チェックリスト

### Phase 1: 即座に実装（法的必須）
1. [ ] **規約ページ**（`/terms`、`/privacy`、`/tokushoho`）
2. [ ] **Cookie同意バナー**
3. [ ] **チャットログ自動削除設定**
4. [ ] **ポイント有効期限管理**
5. [ ] **個人情報の開示・修正・削除リクエスト**
6. [ ] **規約変更通知システム**

---











